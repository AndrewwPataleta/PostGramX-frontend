import{c as T,a as N,j as e,v as w,d as k,e as M,r as m,b as P,t as h}from"./index-CFXlom2a.js";import{u as S}from"./useQuery-XUYd2f_V.js";import{a as A,d as D}from"./formatters-DrHNNfko.js";import{h as v,b as E,c as $}from"./labels-EEWNt0UM.js";import{g as C}from"./tagOptions-DHtvjoWf.js";import{L as z}from"./LoadingSkeleton-BKNgz8ta.js";import{l as O}from"./listingsApi-tBx5zh_S.js";import{g as q}from"./errors-3kY4UU5q.js";import{P as B}from"./plus-DsWi6jvj.js";import"./skeleton-CvuOwLpy.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],I=T("square-pen",H);function F({listing:r,variant:t="full",actionSlot:u}){const{t:s,language:i}=N(),o=r.tags??[],a=[...new Set([...o.filter(n=>n==="Must be pre-approved"),...o.filter(n=>n!=="Must be pre-approved")])],g=t==="compact"?3:a.length,c=a.slice(0,g),x=Math.max(0,a.length-c.length),y=r.visibilityDurationHours??24,p=r.pinDurationHours?v(r.pinDurationHours,s):null,j=v(y,s),l="priceNano"in r?A(r.priceNano,i):D(r.priceTon,i);return e.jsxs("div",{className:`rounded-2xl border border-border/60 bg-card/80 p-4 ${t==="compact"?"space-y-3":"space-y-4"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-foreground",children:[s("listings.format.POST")," â€¢ ",l," ",s("common.ton")]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s(t==="compact"?"listings.perPost":"listings.perPostOffer")})]}),e.jsx("span",{className:`rounded-full px-2.5 py-1 text-[11px] font-semibold ${r.isActive?"bg-emerald-500/15 text-emerald-400":"bg-rose-500/15 text-rose-400"}`,children:r.isActive?s("listings.status.active"):s("listings.status.inactive")})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[e.jsx("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1 text-foreground",children:E(s,r.allowEdits)}),e.jsx("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1 text-foreground",children:$(s,r.allowLinkTracking)})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-foreground",children:[p?e.jsxs("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1",children:[s("listings.pinnedLabel"),": ",p]}):e.jsxs("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1",children:[s("listings.pinnedLabel"),": ",s("common.none")]}),e.jsxs("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1",children:[s("listings.visibleLabel"),": ",j]})]}),a.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-foreground",children:[c.map(n=>{const f=n==="Must be pre-approved";return e.jsx("span",{className:`rounded-full border px-2.5 py-1 ${f?"border-primary/40 bg-primary/10 text-primary":"border-border/60 bg-card text-foreground"}`,children:C(n,s)},n)}),x>0?e.jsxs("span",{className:"rounded-full border border-border/60 bg-card px-2.5 py-1 text-muted-foreground",children:["+",x]}):null]}):null,t==="full"&&u?e.jsx("div",{className:"flex gap-2",children:u}):null]})}const Y=()=>{const{channel:r}=w(),{t}=N(),{id:u}=k(),s=M(),i=u??r.id,o=s.state?.rootBackTo,[a,g]=m.useState(1),[c]=m.useState(10),[x,y]=m.useState(!0),[p,j]=m.useState("recent"),l=S({queryKey:["listingsByChannel",i,{page:a,limit:c,onlyActive:x,sort:p}],queryFn:()=>O({channelId:i,page:a,limit:c,onlyActive:x,sort:p})});m.useEffect(()=>{l.error&&P.error(q(l.error,t("listings.loadError")))},[l.error,t]);const n=l.data?.items??[],f=l.data?.total??0,b=m.useMemo(()=>Math.max(1,Math.ceil(f/c)),[f,c]),L=n.length>0;return e.jsxs(e.Fragment,{children:[l.isLoading?e.jsx(z,{items:3}):L?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:n.map(d=>e.jsx(F,{listing:d,variant:"full",actionSlot:e.jsxs(h,{to:`/channel-manage/${i}/listings/${d.id}/edit`,state:o?{rootBackTo:o}:void 0,className:"flex-1 flex items-center justify-center gap-2 bg-secondary hover:bg-secondary/80 text-foreground font-medium py-2 rounded-lg border border-border transition-colors text-sm",children:[e.jsx(I,{size:16}),t("listings.editAction")]})},d.id))}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:t("common.pageOf",{page:a,total:b})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>g(d=>Math.max(1,d-1)),disabled:a===1,className:"rounded-lg border border-border/60 px-3 py-1 text-xs disabled:opacity-50",children:t("common.previous")}),e.jsx("button",{type:"button",onClick:()=>g(d=>Math.min(b,d+1)),disabled:a>=b,className:"rounded-lg border border-border/60 px-3 py-1 text-xs disabled:opacity-50",children:t("common.next")})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-secondary/30 flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-xl",children:t("listings.emptyIcon")})}),e.jsx("p",{className:"text-foreground font-semibold mb-2",children:t("listings.emptyTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:t("listings.emptySubtitle")}),e.jsx(h,{to:`/channel-manage/${i}/listings/create`,state:o?{rootBackTo:o}:void 0,className:"inline-flex items-center justify-center rounded-lg bg-primary px-4 py-2 text-xs font-semibold text-primary-foreground",children:t("listings.createAction")})]}),e.jsx(h,{to:`/channel-manage/${i}/listings/create`,state:o?{rootBackTo:o}:void 0,className:"fixed bottom-[calc(var(--tg-content-safe-area-inset-bottom)+120px)] right-4 z-40 flex h-12 w-12 items-center justify-center rounded-2xl bg-primary text-primary-foreground shadow-lg shadow-primary/30 transition hover:bg-primary/90","aria-label":t("listings.createAction"),children:e.jsx(B,{size:18})})]})};export{Y as default};
