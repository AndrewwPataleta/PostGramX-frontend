import{u as h,ad as b,r as a,R as j,j as e,ae as v}from"./index-BBZv8y07.js";import{B as m}from"./button-BOY6WDif.js";const N=()=>{const c=h(),{initSession:d,retry:f,isLoading:x,isReady:i,error:s,user:n}=b(),[l,u]=a.useState(!1);a.useEffect(()=>{i&&n||d()},[d,i,n]),a.useEffect(()=>{i&&n&&c(j.MARKETPLACE,{replace:!0})},[i,c,n]),a.useEffect(()=>{if(!l)return;const o=window.setTimeout(()=>u(!1),2e3);return()=>window.clearTimeout(o)},[l]);const r=s?.type==="missing_telegram",t=s?.type==="auth_failed",g=a.useMemo(()=>r?"This mini app must be opened from Telegram.":t?s?.message??"Could not connect to the server.":"Connecting to Telegram…",[s?.message,t,r]),p=async()=>{const o={error:s,mock:v,timestamp:new Date().toISOString()};await navigator.clipboard.writeText(JSON.stringify(o,null,2)),u(!0)};return e.jsx("div",{className:"safe-area-top safe-area-bottom flex min-h-screen w-full items-center justify-center overflow-hidden bg-background px-6 text-center",children:e.jsxs("div",{className:"flex w-full max-w-sm flex-col items-center gap-6",children:[null,e.jsxs("div",{className:"relative flex h-24 w-24 items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 rounded-full bg-gradient-to-br from-sky-500/70 via-blue-500/70 to-indigo-600/70 blur-2xl opacity-80"}),e.jsx("div",{className:"relative z-10 flex h-16 w-16 items-center justify-center rounded-2xl bg-gradient-to-br from-sky-400 via-blue-500 to-indigo-600 shadow-[0_0_25px_rgba(56,189,248,0.45)]",children:e.jsx("span",{className:"text-lg font-semibold tracking-[0.2em] text-white",children:"X"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h1",{className:"text-lg font-semibold",children:r?"Open in Telegram":t?"Couldn’t connect":""}),e.jsx("p",{className:"text-sm text-muted-foreground",children:g}),s?.debug?e.jsx("p",{className:"text-xs text-muted-foreground",children:s.debug}):null]}),!r&&!t?e.jsxs("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[e.jsx("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-primary/40 border-t-primary"}),e.jsx("span",{children:x?"Authorizing session…":"Preparing session…"})]}):null,(r||t)&&e.jsxs("div",{className:"flex w-full flex-col gap-3",children:[e.jsx(m,{onClick:f,className:"w-full",children:"Retry"}),t?e.jsx(m,{onClick:p,variant:"outline",className:"w-full",children:l?"Copied":"Copy debug info"}):null]})]})})};export{N as default};
