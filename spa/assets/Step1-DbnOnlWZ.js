import{n as C,r as i,j as e,y as j,o as v}from"./index-CBnBcs6e.js";import{u as N}from"./useMutation-C0dKMxUV.js";import{B as b}from"./button-sMp6Dr3V.js";import{I as k}from"./input-DksepTgu.js";import{C as E,a as L}from"./card-6I4zp-rt.js";import{a as w}from"./channels-DN945PI3.js";import{g as y}from"./errorMapping-Duqv1rhn.js";import{u as I}from"./useAddChannelFlow-BIq6qNLY.js";const R=()=>{const d=C(),{state:a,setUsernameOrLink:m,setPreview:h,setLinkedChannelId:x,setLinkStatus:f,setVerifyStatus:p,setLastError:c}=I(),[r,u]=i.useState(a.usernameOrLink),[l,t]=i.useState(null);i.useEffect(()=>{u(a.usernameOrLink)},[a.usernameOrLink]);const o=N({mutationFn:n=>w({usernameOrLink:n}),onSuccess:(n,s)=>{h(n),m(s),x(null),f("idle"),p("idle"),c(null),t(null),d("/add-channel/step-2")},onError:n=>{const s=y(n);t(s),c(s),v.error(s)}}),g=()=>{const n=r.trim();if(!n){t("Please enter a channel username or link.");return}o.mutate(n)};return e.jsxs("div",{className:"flex flex-1 flex-col gap-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-base font-semibold text-foreground",children:"Add a Telegram channel"})}),e.jsx(E,{className:"border-border/60 bg-card/80 shadow-sm",children:e.jsxs(L,{className:"space-y-3 p-4",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Channel username or link"}),e.jsx(k,{placeholder:"@mychannel or https://t.me/mychannel",value:r,onChange:n=>{const s=n.target.value;u(s),m(s),l&&t(null)}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Public channels only. You must be an admin of the channel."}),l?e.jsx("p",{className:"text-xs font-medium text-destructive",children:l}):null]})}),e.jsx("div",{className:"mt-auto flex flex-col gap-3",children:e.jsx(b,{onClick:g,disabled:o.isPending||!r.trim(),className:"w-full text-sm font-semibold",children:o.isPending?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 animate-spin"}),"Checking channel"]}):"Continue"})})]})};export{R as default};
