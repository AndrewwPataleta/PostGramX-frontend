import{u as b,b as g,d as j,r as m,j as e,L as y,a as N}from"./index-EXWFkzZx.js";import{u as v,R as C,g as k,a as w}from"./useVerifyChannel-D5cOyYGV.js";import{P as u}from"./PageContainer-CPQamPVO.js";import{C as f}from"./chevron-left-CxIEZgqf.js";import"./useMutation-D71vzVvV.js";import"./channelsApi-DjNO8p7p.js";const E=t=>t==null?"–":t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString(),I=()=>{const t=b(),{id:a}=g(),o=j(),[c,l]=m.useState(null),{mutateAsync:p,isPending:d}=v(),n=m.useMemo(()=>o.state?.channel??null,[o.state]),s=o.state?.rootBackTo,h=async()=>{if(a){l(null);try{const r=await p(a);if(r.status==="VERIFIED"){const x=n?{...n,status:"VERIFIED"}:void 0;t(`/channel-manage/${a}/listings`,{replace:!0,state:x?{channel:x,rootBackTo:s}:s?{rootBackTo:s}:void 0});return}const i=k(r,"Verification failed. Please check your bot permissions and retry.");l(i)}catch(r){const i=w(r,"Unable to verify the channel right now.");l(i),N.error(i)}}};if(!a){const r=()=>{if(s){t(s,{replace:!0});return}t(-1)};return e.jsx("div",{className:"mx-auto w-full max-w-2xl",children:e.jsxs(u,{className:"py-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Channel not found."}),e.jsxs("button",{type:"button",onClick:r,className:"mt-4 inline-flex items-center gap-2 text-xs font-semibold text-primary",children:[e.jsx(f,{size:14}),"Back"]})]})})}return e.jsx("div",{className:"mx-auto flex w-full max-w-2xl flex-col",children:e.jsxs(u,{className:"py-6 space-y-6",children:[e.jsxs("button",{type:"button",onClick:()=>{if(s){t(s,{replace:!0});return}t(-1)},className:"inline-flex items-center gap-2 text-xs font-semibold text-muted-foreground",children:[e.jsx(f,{size:14}),"Back"]}),e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground",children:"Pending Verification"}),e.jsx("h1",{className:"mt-1 text-lg font-semibold text-foreground",children:n?.title||"Channel verification"}),n?.username?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",n.username]}):null]}),e.jsx("span",{className:"rounded-full border border-yellow-500/40 bg-yellow-500/15 px-3 py-1 text-[11px] font-semibold text-yellow-200",children:"Pending"})]}),e.jsxs("div",{className:"mt-4 rounded-xl bg-muted/30 p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Members"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-foreground",children:E(n?.memberCount)})]})]}),e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/70 p-5 text-sm text-muted-foreground",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Finish verification"}),e.jsxs("ul",{className:"mt-3 list-disc space-y-2 pl-5 text-xs",children:[e.jsx("li",{children:"Add the PostGram bot as an admin in your channel."}),e.jsx("li",{children:"Enable the “Post messages” permission for the bot."}),e.jsx("li",{children:"Return here and retry verification."})]})]}),c?e.jsx("div",{className:"rounded-xl border border-destructive/40 bg-destructive/10 px-4 py-3 text-xs text-destructive",children:c}):null,e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("button",{type:"button",onClick:h,disabled:d,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-3 text-sm font-semibold text-primary-foreground transition disabled:cursor-not-allowed disabled:opacity-70",children:[d?e.jsx(y,{size:16,className:"animate-spin"}):e.jsx(C,{size:16}),"Retry verification"]}),e.jsx("button",{type:"button",onClick:()=>t("/channels"),className:"inline-flex items-center justify-center rounded-lg border border-border/60 bg-card/80 px-4 py-3 text-sm font-semibold text-foreground",children:"Back to channels"})]})]})})};export{I as default};
