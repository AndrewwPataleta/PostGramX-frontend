import{n as h,u as b,z as g,r as x,j as e,y as j,o as y}from"./index-BY9FTZY2.js";import{u as N,R as v,g as w,a as C}from"./useVerifyChannel-DW7k8Dwp.js";import{C as m}from"./chevron-left-C5ZF9UHJ.js";import"./useMutation-sHeX_CkL.js";import"./channels-DUcPGUZS.js";const u=t=>t==null?"–":t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString(),M=()=>{const t=h(),{id:n}=b(),a=g(),[l,o]=x.useState(null),{mutateAsync:f,isPending:d}=N(),s=x.useMemo(()=>a.state?.channel??null,[a.state]),p=async()=>{if(n){o(null);try{const r=await f(n);if(r.status==="VERIFIED"){const c=s?{...s,status:"VERIFIED"}:void 0;t(`/channel-manage/${n}/overview`,{replace:!0,state:c?{channel:c}:void 0});return}const i=w(r,"Verification failed. Please check your bot permissions and retry.");o(i)}catch(r){const i=C(r,"Unable to verify the channel right now.");o(i),y.error(i)}}};return n?e.jsxs("div",{className:"mx-auto flex w-full max-w-2xl flex-col gap-6 px-4 py-6",children:[e.jsxs("button",{type:"button",onClick:()=>t(-1),className:"inline-flex items-center gap-2 text-xs font-semibold text-muted-foreground",children:[e.jsx(m,{size:14}),"Back"]}),e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase text-muted-foreground",children:"Pending Verification"}),e.jsx("h1",{className:"mt-1 text-lg font-semibold text-foreground",children:s?.title||"Channel verification"}),s?.username?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",s.username]}):null]}),e.jsx("span",{className:"rounded-full border border-yellow-500/40 bg-yellow-500/15 px-3 py-1 text-[11px] font-semibold text-yellow-200",children:"Pending"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"rounded-xl bg-muted/30 p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Members"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-foreground",children:u(s?.memberCount)})]}),e.jsxs("div",{className:"rounded-xl bg-muted/30 p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg. Views"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-foreground",children:u(s?.avgViews)})]})]})]}),e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/70 p-5 text-sm text-muted-foreground",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Finish verification"}),e.jsxs("ul",{className:"mt-3 list-disc space-y-2 pl-5 text-xs",children:[e.jsx("li",{children:"Add the PostGram bot as an admin in your channel."}),e.jsx("li",{children:"Enable the “Post messages” permission for the bot."}),e.jsx("li",{children:"Return here and retry verification."})]})]}),l?e.jsx("div",{className:"rounded-xl border border-destructive/40 bg-destructive/10 px-4 py-3 text-xs text-destructive",children:l}):null,e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("button",{type:"button",onClick:p,disabled:d,className:"inline-flex items-center justify-center gap-2 rounded-full bg-primary px-4 py-3 text-sm font-semibold text-primary-foreground transition disabled:cursor-not-allowed disabled:opacity-70",children:[d?e.jsx(j,{size:16,className:"animate-spin"}):e.jsx(v,{size:16}),"Retry verification"]}),e.jsx("button",{type:"button",onClick:()=>t("/channels"),className:"inline-flex items-center justify-center rounded-full border border-border/60 bg-card/80 px-4 py-3 text-sm font-semibold text-foreground",children:"Back to channels"})]})]}):e.jsxs("div",{className:"mx-auto w-full max-w-2xl px-4 py-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Channel not found."}),e.jsxs("button",{type:"button",onClick:()=>t(-1),className:"mt-4 inline-flex items-center gap-2 text-xs font-semibold text-primary",children:[e.jsx(m,{size:14}),"Back"]})]})};export{M as default};
