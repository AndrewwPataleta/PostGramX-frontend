import{c as _,r as d,j as e,a as E,L as K,X as S,u as U}from"./index-BVFfoKPu.js";import{u as q}from"./useQuery-DECTS7wu.js";import{l as G}from"./listingsApi-DIKDp0fN.js";import{S as v}from"./skeleton-BZVhub6W.js";import{f as D,n as Q}from"./ton-ClBVV2oW.js";import{C as H}from"./check-CrsBVuFH.js";import{C as N}from"./chevron-down-DqZ0BwrS.js";import{f as B,l as X}from"./tagOptions-DoUmU6u5.js";import{E as W}from"./ErrorState-CLdoMIXJ.js";import{g as V}from"./errors-3kY4UU5q.js";import{c as J}from"./channelsApi-BltVTiM-.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Z=_("search",Y);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],se=_("sliders-horizontal",ee),P="Must be pre-approved",M=3,re=24,te=5,ae=s=>{try{return BigInt(s)}catch{return null}},I=s=>s>=168&&s%24===0?`${s/24}d`:`${s}h`,ne=s=>{try{return D(Q(s))}catch{return s}},oe=s=>{const o=s.map(a=>a.trim()).filter(a=>a.length>0&&a.length<=re),c=o.filter(a=>a.toLowerCase()===P.toLowerCase()),n=o.filter(a=>a.toLowerCase()!==P.toLowerCase()),m=Array.from(new Set([...c,...n]));return{visible:m.slice(0,M),hiddenCount:Math.max(m.length-M,0)}},le=s=>{const o=[...s.allowEdits?["Edits allowed"]:[],...s.allowLinkTracking?["Tracking allowed"]:[],...s.allowPinnedPlacement||s.pinDurationHours!==null?["Pinned available"]:[]];return o.length===0?["Standard placement"]:o},ie=s=>[...s.requiresApproval?["Pre-approval required"]:[],`Pinned: ${s.pinDurationHours?I(s.pinDurationHours):"none"}`,`Visible: ${I(s.visibilityDurationHours)}`];function de({channel:s}){const[o,c]=d.useState(!1),n=q({queryKey:["marketplaceListingsByChannel",s.id],queryFn:()=>G({channelId:s.id,page:1,limit:te,onlyActive:!0,sort:"price_asc"}),enabled:o,staleTime:1e3*60*5,refetchOnMount:!1}),m=n.data?.items??s.listings??[],a=d.useMemo(()=>typeof s.placementsCount=="number"?s.placementsCount:typeof s.listingsCount=="number"?s.listingsCount:n.data?n.data.total??n.data.items.length:s.listings?s.listings.length:null,[s.listings,s.placementsCount,n.data]),i=d.useMemo(()=>m.length===0?null:m.reduce((l,g)=>{const f=ae(g.priceNano);return f===null?l:l===null||f<l?f:l},null),[m]),j=i?D(Q(i)):null,w=typeof s.subscribers=="number"?`${s.subscribers.toLocaleString()} subscribers`:"— subscribers",u=s.name?.[0]?.toUpperCase()??s.username?.[0]?.toUpperCase(),C=s.username?`@${s.username}`:null;return e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card/80 p-4 transition-colors hover:border-primary/40",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[s.avatarUrl?e.jsx("img",{src:s.avatarUrl,alt:s.name,className:"h-12 w-12 rounded-full object-cover"}):e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-primary/30 via-secondary/50 to-secondary text-lg text-foreground",children:u??"?"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:s.name}),s.verified?e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-primary/20 p-1",children:e.jsx(H,{size:12,className:"text-primary"})}):null]}),C?e.jsx("span",{className:"text-xs text-muted-foreground",children:C}):null]}),e.jsx("button",{type:"button",onClick:()=>c(l=>!l),"aria-expanded":o,className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-border/60 bg-secondary/40 text-muted-foreground transition hover:text-foreground",children:e.jsx(N,{size:16,className:E("transition-transform duration-200",o&&"rotate-180")})})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:typeof a=="number"?`${a} placements`:"— placements"}),e.jsx("span",{children:"·"}),e.jsx("span",{children:w})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:e.jsxs("span",{children:["From ",e.jsxs("span",{className:"font-semibold text-primary",children:[j??"--"," TON"]})]})})]})]}),e.jsx("div",{className:E("overflow-hidden transition-all duration-300",o?"mt-4 max-h-[1200px] opacity-100":"max-h-0 opacity-0"),children:e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-background/60 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Placements"}),e.jsx(K,{to:`/marketplace/channels/${s.id}`,state:{channel:s},className:"text-[11px] font-semibold text-primary",children:"Open channel"})]}),n.isLoading?e.jsx("div",{className:"mt-3 space-y-3",children:Array.from({length:2}).map((l,g)=>e.jsxs("div",{className:"rounded-xl border border-border/50 bg-card/80 p-3",children:[e.jsx(v,{className:"h-4 w-24"}),e.jsx(v,{className:"mt-2 h-3 w-40"}),e.jsx(v,{className:"mt-2 h-3 w-28"})]},`listing-skeleton-${s.id}-${g}`))}):n.isError?e.jsx("div",{className:"mt-3 rounded-xl border border-border/60 bg-red-500/5 p-3 text-xs text-red-200",children:"Failed to load placements."}):m.length>0?e.jsx("div",{className:"mt-3 space-y-3",children:m.map(l=>{const g=oe(l.tags??[]),f=le(l),p=ie(l),F=l.contentRulesText?.trim();return e.jsxs("div",{className:"rounded-xl border border-border/60 bg-card/80 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[ne(l.priceNano)," TON"]}),e.jsx("span",{className:"rounded-full border border-border/60 bg-muted/40 px-2 py-0.5 text-[10px] font-semibold text-muted-foreground",children:l.format}),l.isActive?e.jsx("span",{className:"rounded-full border border-emerald-500/40 bg-emerald-500/15 px-2 py-0.5 text-[10px] font-semibold text-emerald-300",children:"Active"}):null]}),g.visible.length>0?e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] text-foreground",children:[g.visible.map(b=>e.jsx("span",{className:E("rounded-full border px-2.5 py-1",b.toLowerCase()===P.toLowerCase()?"border-primary/40 bg-primary/10 text-primary":"border-border/60 bg-card text-foreground"),children:b},b)),g.hiddenCount>0?e.jsxs("span",{className:"rounded-full border border-border/60 bg-card px-2.5 py-1 text-muted-foreground",children:["+",g.hiddenCount]}):null]}):null,e.jsxs("div",{className:"mt-3 grid gap-3 text-[11px] text-muted-foreground sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-muted-foreground/80",children:"Allowed"}),e.jsx("div",{className:"mt-1 space-y-1",children:f.map(b=>e.jsx("p",{children:b},b))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-muted-foreground/80",children:"Requires"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[p.map(b=>e.jsx("p",{children:b},b)),F?e.jsxs("div",{className:"pt-1",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-muted-foreground/70",children:"Requirements"}),e.jsx("p",{className:"truncate text-[11px] text-muted-foreground",children:F})]}):null]})]})]})]},l.id)})}):e.jsx("div",{className:"mt-3 rounded-xl border border-dashed border-border/60 bg-card/60 p-4 text-center text-xs text-muted-foreground",children:"No placements available yet."})]})})]})}const ce=({filters:s,onRemoveFilter:o})=>s.priceRange[0]>0||s.priceRange[1]<10||s.subscribersRange[0]>0||s.subscribersRange[1]<1e6||s.languages.length>0||s.categories.length>0||s.tags.length>0||s.verifiedOnly?e.jsx("div",{className:"px-4 py-3 bg-secondary/30 border-b border-border/30 space-y-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[s.priceRange[0]>0||s.priceRange[1]<10?e.jsxs("button",{onClick:()=>o("priceRange"),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Price: ",s.priceRange[0].toFixed(1),"-",s.priceRange[1].toFixed(1)," TON",e.jsx(S,{size:14})]}):null,s.subscribersRange[0]>0||s.subscribersRange[1]<1e6?e.jsxs("button",{onClick:()=>o("subscribersRange"),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Subs: ",(s.subscribersRange[0]/1e3).toFixed(0),"K-",(s.subscribersRange[1]/1e3).toFixed(0),"K",e.jsx(S,{size:14})]}):null,s.verifiedOnly?e.jsxs("button",{onClick:()=>o("verifiedOnly"),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Verified Only",e.jsx(S,{size:14})]}):null,s.languages.map(n=>e.jsxs("button",{onClick:()=>o("languages",n),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[n,e.jsx(S,{size:14})]},n)),s.categories.map(n=>e.jsxs("button",{onClick:()=>o("categories",n),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[n,e.jsx(S,{size:14})]},n)),s.tags.map(n=>e.jsxs("button",{onClick:()=>o("tags",n),className:"inline-flex items-center gap-1.5 bg-secondary/70 hover:bg-secondary text-foreground px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[n,e.jsx(S,{size:14})]},n))]})}):null,ue=["EN","RU","ES","AR","DE","Other"],xe=["Crypto","Finance","Gaming","Tech","Lifestyle","News"],me=({isOpen:s,onClose:o,filters:c,onApply:n,onReset:m})=>{const[a,i]=d.useState(c),j=(r,t=1)=>new Intl.NumberFormat("en",{maximumFractionDigits:t}).format(r),w=r=>new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1}).format(r),[u,C]=d.useState({pricing:!0,audience:!0,language:!1,category:!1,tags:!1,availability:!1,verification:!1}),[l,g]=d.useState(""),[f,p]=d.useState(""),F=B(X),b=[{label:"Any",range:[0,10]},{label:"0-1 TON",range:[0,1]},{label:"1-5 TON",range:[1,5]},{label:"5-10 TON",range:[5,10]}],z=[{label:"Any",range:[0,1e6]},{label:"0-10K",range:[0,1e4]},{label:"10-100K",range:[1e4,1e5]},{label:"100K-1M",range:[1e5,1e6]}];d.useEffect(()=>{i(c)},[c,s]);const y=r=>{C(t=>({...t,[r]:!t[r]}))},A=(r,t)=>{const x=[...a.priceRange];x[r]=t,i(L=>({...L,priceRange:x}))},O=(r,t)=>{const x=[...a.subscribersRange];x[r]=t,i(L=>({...L,subscribersRange:x}))},R=r=>{i(t=>({...t,languages:t.languages.includes(r)?t.languages.filter(x=>x!==r):[...t.languages,r]}))},T=r=>{i(t=>({...t,categories:t.categories.includes(r)?t.categories.filter(x=>x!==r):[...t.categories,r]}))},h=()=>{n(a),o()},k=()=>{m(),i({priceRange:[0,10],subscribersRange:[0,1e6],languages:[],categories:[],tags:[],verifiedOnly:!1,dateRange:["",""]})};return s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:o}),e.jsxs("div",{className:"fixed inset-x-0 bottom-0 top-0 bg-card rounded-t-2xl z-50 animate-in slide-in-from-bottom-10 duration-300 flex flex-col h-[100dvh] sm:h-auto sm:top-auto sm:max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-card border-b border-border/50 px-4 py-4 flex items-center justify-between rounded-t-2xl shrink-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Filters"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-secondary rounded-lg transition-colors",children:e.jsx(S,{size:20,className:"text-foreground"})})]}),e.jsxs("div",{className:"px-4 py-4 space-y-4 flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y("pricing"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Pricing (TON)"}),e.jsx(N,{size:18,className:`text-muted-foreground transition-transform ${u.pricing?"rotate-180":""}`})]}),u.pricing&&e.jsxs("div",{className:"px-3 space-y-3 pb-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:b.map(r=>e.jsx("button",{onClick:()=>i(t=>({...t,priceRange:r.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${a.priceRange[0]===r.range[0]&&a.priceRange[1]===r.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:r.label},r.label))}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:a.priceRange[0],onChange:r=>A(0,parseFloat(r.target.value)||0),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min"}),e.jsx("input",{type:"number",value:a.priceRange[1],onChange:r=>A(1,parseFloat(r.target.value)||10),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[j(a.priceRange[0])," -"," ",j(a.priceRange[1])," TON"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y("audience"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Audience"}),e.jsx(N,{size:18,className:`text-muted-foreground transition-transform ${u.audience?"rotate-180":""}`})]}),u.audience&&e.jsx("div",{className:"px-3 space-y-4 pb-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Subscribers"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:z.map(r=>e.jsx("button",{onClick:()=>i(t=>({...t,subscribersRange:r.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${a.subscribersRange[0]===r.range[0]&&a.subscribersRange[1]===r.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:r.label},r.label))}),e.jsxs("div",{className:"flex flex-col gap-2 mb-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:a.subscribersRange[0],onChange:r=>O(0,parseInt(r.target.value)||0),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min"}),e.jsx("input",{type:"number",value:a.subscribersRange[1],onChange:r=>O(1,parseInt(r.target.value)||1e6),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[w(a.subscribersRange[0])," -"," ",w(a.subscribersRange[1])]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y("language"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Language"}),e.jsx(N,{size:18,className:`text-muted-foreground transition-transform ${u.language?"rotate-180":""}`})]}),u.language&&e.jsx("div",{className:"px-3 pb-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:ue.map(r=>e.jsx("button",{onClick:()=>R(r),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${a.languages.includes(r)?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:r},r))})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y("category"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Category"}),e.jsx(N,{size:18,className:`text-muted-foreground transition-transform ${u.category?"rotate-180":""}`})]}),u.category&&e.jsx("div",{className:"px-3 pb-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.map(r=>e.jsx("button",{onClick:()=>T(r),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${a.categories.includes(r)?"bg-accent text-accent-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:r},r))})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y("tags"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Tags"}),e.jsx(N,{size:18,className:`text-muted-foreground transition-transform ${u.tags?"rotate-180":""}`})]}),u.tags&&e.jsxs("div",{className:"px-3 pb-3 space-y-3",children:[e.jsx("input",{type:"text",value:l,onChange:r=>g(r.target.value),placeholder:"Search tags",className:"w-full rounded-lg border border-border bg-input px-3 py-2 text-sm text-foreground"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:f,onChange:r=>p(r.target.value),placeholder:"Add custom tag",className:"flex-1 rounded-lg border border-border bg-input px-3 py-2 text-sm text-foreground"}),e.jsx("button",{type:"button",onClick:()=>{const r=f.trim();r&&(i(t=>({...t,tags:t.tags.includes(r)?t.tags:[...t.tags,r]})),p(""))},className:"rounded-lg border border-primary/40 bg-primary/10 px-3 py-2 text-xs font-semibold text-primary",children:"Add"})]}),a.tags.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(r=>e.jsxs("button",{type:"button",onClick:()=>i(t=>({...t,tags:t.tags.filter(x=>x!==r)})),className:"rounded-full bg-secondary px-3 py-1 text-xs text-foreground hover:bg-secondary/80",children:[r," ×"]},r))}):null,e.jsx("div",{className:"flex flex-wrap gap-2",children:F.filter(r=>r.toLowerCase().includes(l.trim().toLowerCase())).map(r=>{const t=a.tags.includes(r);return e.jsx("button",{type:"button",onClick:()=>i(x=>({...x,tags:t?x.tags.filter(L=>L!==r):[...x.tags,r]})),className:`rounded-full border px-3 py-1 text-xs transition-colors ${t?"border-primary/60 bg-primary/20 text-primary":"border-border/60 bg-card text-muted-foreground hover:text-foreground"}`,children:r},r)})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y("availability"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Availability"}),e.jsx(N,{size:18,className:`text-muted-foreground transition-transform ${u.availability?"rotate-180":""}`})]}),u.availability&&e.jsxs("div",{className:"px-3 pb-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"From date"}),e.jsx("input",{type:"date",value:a.dateRange[0],onChange:r=>i(t=>({...t,dateRange:[r.target.value,t.dateRange[1]]})),className:"w-full bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"To date"}),e.jsx("input",{type:"date",value:a.dateRange[1],onChange:r=>i(t=>({...t,dateRange:[t.dateRange[0],r.target.value]})),className:"w-full bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>y("verification"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Verification"}),e.jsx(N,{size:18,className:`text-muted-foreground transition-transform ${u.verification?"rotate-180":""}`})]}),u.verification&&e.jsx("div",{className:"px-3 pb-3",children:e.jsxs("label",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("input",{type:"checkbox",checked:a.verifiedOnly,onChange:r=>i(t=>({...t,verifiedOnly:r.target.checked})),className:"w-5 h-5 bg-secondary border border-border rounded accent-primary cursor-pointer"}),e.jsx("span",{className:"text-foreground font-medium",children:"Verified channels only"})]})})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-card border-t border-border/50 px-4 py-4 space-y-3",children:[e.jsx("button",{onClick:h,className:"button-primary w-full py-3 text-base font-semibold",children:"Apply Filters"}),e.jsx("button",{onClick:k,className:"button-secondary w-full py-3 text-base font-semibold",children:"Reset"})]})]})]}):null},$={priceRange:[0,100],subscribersRange:[0,1e6],languages:[],categories:[],tags:[],verifiedOnly:!0,dateRange:["",""]},ge={channels:s=>["channels",s]},pe=()=>{const[s,o]=d.useState(""),[c,n]=d.useState(""),[m,a]=d.useState(!1),[i,j]=d.useState($),[w,u]=d.useState(1),[C]=d.useState(20),[l]=d.useState("recent"),[g]=d.useState("desc");d.useEffect(()=>{const R=window.setTimeout(()=>{n(s.trim())},300);return()=>{window.clearTimeout(R)}},[s]);const f=d.useMemo(()=>({q:c||void 0,verifiedOnly:i.verifiedOnly||void 0,page:w,limit:C,sort:l,order:g,includeListings:!1}),[c,i.verifiedOnly,C,g,w,l]),p=q({queryKey:ge.channels(f),queryFn:()=>J.listChannels(f)});d.useEffect(()=>{p.error&&U.error(V(p.error,"Unable to load channels"))},[p.error]);const F=d.useMemo(()=>p.data?.items??[],[p.data?.items]),b=(R,T)=>{j(h=>{switch(R){case"priceRange":return{...h,priceRange:$.priceRange};case"subscribersRange":return{...h,subscribersRange:$.subscribersRange};case"verifiedOnly":return{...h,verifiedOnly:!1};case"languages":return{...h,languages:h.languages.filter(k=>k!==T)};case"categories":return{...h,categories:h.categories.filter(k=>k!==T)};case"tags":return{...h,tags:h.tags.filter(k=>k!==T)};default:return h}})},z=()=>a(!0),y=()=>a(!1),A=R=>j(R),O=()=>j($);return{state:{searchQuery:s,isFilterOpen:m,filters:i,isLoading:p.isLoading,error:p.error},computed:{channels:F},actions:{setSearchQuery:o,openFilters:z,closeFilters:y,applyFilters:A,resetFilters:O,removeFilter:b,refetch:()=>p.refetch(),setPage:u}}};function Se(){const{state:s,computed:o,actions:c}=pe();return e.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"px-4 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-semibold text-foreground",children:"Marketplace"}),e.jsxs("button",{type:"button",onClick:c.openFilters,className:"inline-flex items-center gap-2 rounded-full bg-secondary/60 px-3 py-1 text-xs text-muted-foreground",children:[e.jsx(se,{size:14}),"Filters"]})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-border/60 bg-card px-3 py-2",children:[e.jsx(Z,{size:16,className:"text-muted-foreground"}),e.jsx("input",{value:s.searchQuery,onChange:n=>c.setSearchQuery(n.target.value),placeholder:"Search channels or @username",className:"flex-1 bg-transparent text-sm text-foreground placeholder:text-muted-foreground focus:outline-none"})]}),e.jsx(ce,{filters:s.filters,onRemoveFilter:c.removeFilter})]}),e.jsxs("div",{className:"px-4 py-6 space-y-3",children:[s.isLoading?Array.from({length:5}).map((n,m)=>e.jsx("div",{className:"rounded-2xl border border-border/50 bg-card/80 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(v,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(v,{className:"h-4 w-40"}),e.jsx(v,{className:"h-3 w-24"}),e.jsx(v,{className:"h-3 w-32"})]}),e.jsx(v,{className:"h-4 w-16"})]})},`marketplace-skeleton-${m}`)):o.channels.map(n=>e.jsx(de,{channel:n},n.id)),!s.isLoading&&s.error?e.jsx(W,{message:V(s.error,"Unable to load channels"),description:"Please try again when you have a stable connection.",onRetry:c.refetch}):null,!s.isLoading&&!s.error&&o.channels.length===0?e.jsx("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-6 text-center text-sm text-muted-foreground",children:"No channels found. Try a new search."}):null]}),e.jsx(me,{isOpen:s.isFilterOpen,onClose:c.closeFilters,filters:s.filters,onApply:c.applyFilters,onReset:c.resetFilters})]})}export{Se as default};
