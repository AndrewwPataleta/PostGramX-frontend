import{d as L,e as V,u as R,a as k,r as c,j as e,R as h,L as A,W as S,S as F,b as T}from"./index-JWVuw5_E.js";import{u as M,R as P,g as D,a as _}from"./useVerifyChannel-QI8hRqKE.js";import{m as g}from"./managedChannels-CFOjhX_b.js";import{P as N}from"./PageContainer-D4fjnPhF.js";import{f as G}from"./formatters-wdUg6iBq.js";import{C as d}from"./channels-CCH0-4EZ.js";import"./useMutation-D-MoZErO.js";import"./channelsApi-Bm8bf4CF.js";import"./ton-ClBVV2oW.js";const $=(s,i)=>({id:s.id,name:s.title||i,username:s.username.startsWith("@")?s.username:`@${s.username}`,avatar:"ðŸ“£",status:s.status,verified:s.status===d.VERIFIED,subscribers:s.memberCount??0,activeDeals:0,description:void 0}),K=()=>{const{id:s}=L(),i=V(),y=R(),{t,language:j}=k(),{mutateAsync:v,isPending:x}=M(),[f,m]=c.useState(null),l=c.useMemo(()=>i.state?.channel??null,[i.state]),o=i.state?.rootBackTo,u=c.useMemo(()=>l?$(l,t("channels.untitled")):null,[l,t]),[n,p]=c.useState(()=>s?u??g[s]??null:null);c.useEffect(()=>{if(!s){p(null);return}const a=u??g[s]??null;p(r=>a||(r?.id===s?r:null))},[u,s]);const E=n?.status===d.PENDING_VERIFY;if(!n)return e.jsx("div",{className:"w-full max-w-2xl mx-auto",children:e.jsx(N,{className:"py-6",children:e.jsx("p",{className:"text-muted-foreground",children:t("channels.notFound")})})});const w=async()=>{if(s){m(null);try{const a=await v(s);if(a.status===d.VERIFIED){const b=l?{...l,status:d.VERIFIED}:void 0;y(h.CHANNEL_MANAGE_LISTINGS(s),{replace:!0,state:b?{channel:b,rootBackTo:o}:o?{rootBackTo:o}:void 0});return}const r=D(a,t("channels.verifyFailed"));m(r)}catch(a){const r=_(a,t("channels.verifyUnavailable"));m(r),T.error(r)}}},C=h.CHANNEL_MANAGE(n.id),I={channel:n};return e.jsx("div",{className:"w-full max-w-2xl mx-auto",children:e.jsxs(N,{className:"pt-6",children:[e.jsxs("div",{className:"py-6 bg-gradient-to-b from-card/50 to-transparent",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-primary/40 to-accent/40 flex items-center justify-center text-4xl flex-shrink-0",children:n.avatar||t("channels.avatarFallback")}),e.jsxs("div",{children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("h2",{className:"text-xl font-bold text-foreground",children:n.name})}),e.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:n.username}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[G(n.subscribers,j)," ",t("marketplace.subscribers")]})]})]}),E?e.jsxs("div",{className:"rounded-2xl border border-yellow-500/40 bg-yellow-500/10 px-4 py-3 text-xs text-yellow-100",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-yellow-100",children:t("channels.pendingVerificationTitle")}),e.jsx("p",{className:"text-yellow-100/80",children:t("channels.pendingVerificationSubtitle")})]}),e.jsxs("button",{type:"button",onClick:w,disabled:x,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-yellow-500/80 px-4 py-2 text-xs font-semibold text-yellow-950 transition disabled:cursor-not-allowed disabled:opacity-70",children:[x?e.jsx(A,{size:14,className:"animate-spin"}):e.jsx(P,{size:14}),t("channels.retryVerification")]})]}),f?e.jsx("p",{className:"mt-2 text-[11px] text-yellow-100/80",children:f}):null]}):null]}),e.jsx("div",{className:"border-b border-border/50 bg-card/80 backdrop-blur-glass",children:e.jsx("div",{className:"flex gap-6",children:[{id:"listings",label:t("listings.title")},{id:"settings",label:t("channels.settingsTitle")}].map(a=>e.jsx(S,{to:`${C}/${a.id}`,state:l||o?{channel:l??void 0,rootBackTo:o}:void 0,className:({isActive:r})=>`py-3 font-medium text-sm border-b-2 transition-colors ${r?"text-primary border-b-primary":"text-muted-foreground border-b-transparent hover:text-foreground"}`,children:a.label},a.id))})}),e.jsx("div",{className:"py-6 space-y-4",children:e.jsx(F,{context:I})})]})})};export{K as default};
