import{c as _,j as r,f as te,e as x,u as l,a as re,r as E,h as se,i as ae,k as ne}from"./index-DrYRFlek.js";import{b as ie,a as oe}from"./payment-BuGK4VCJ.js";import{u as le}from"./useQuery-LSgj3zZv.js";import{u as w}from"./useMutation-Cr4S1tLo.js";import{g as u}from"./errors-3kY4UU5q.js";import{L as ce}from"./LoadingSkeleton-yQAv_khj.js";import{E as de}from"./ErrorState-D8fCXnCV.js";import"./useBaseQuery-CG7f0wAv.js";import"./skeleton-DMrimzyT.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],L=_("copy",ue);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]],pe=_("link",me),fe={primary:"bg-primary/20 text-primary",warning:"bg-yellow-500/20 text-yellow-300",info:"bg-sky-500/15 text-sky-200",success:"bg-emerald-500/20 text-emerald-300",neutral:"bg-muted text-muted-foreground",danger:"bg-rose-500/20 text-rose-300"};function ge({label:t,tone:e,className:s}){return r.jsx("span",{className:te("inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold",fe[e],s),children:t})}function xe({status:t,tone:e,title:s,username:o,verified:d,price:y,dealId:A,avatarUrl:f,statusDescription:a}){return r.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-6",children:[r.jsxs("div",{className:"flex items-center gap-3",children:[r.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-secondary/60 text-xl",children:f?f.startsWith("http")?r.jsx("img",{src:f,alt:s,className:"h-full w-full rounded-full object-cover"}):f:s.slice(0,1)}),r.jsxs("div",{className:"flex-1",children:[r.jsxs("div",{className:"flex items-center gap-2 text-sm font-semibold text-foreground",children:[r.jsx("span",{children:s}),d?r.jsx("span",{className:"inline-flex h-4 w-4 items-center justify-center rounded-full bg-primary/20 text-[10px] text-primary",children:"âœ“"}):null]}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:["@",o]})]}),r.jsxs("div",{className:"text-right text-xs text-muted-foreground",children:[r.jsx("p",{className:"font-semibold text-foreground",children:y}),r.jsx("p",{children:A})]})]}),r.jsxs("div",{className:"mt-4 space-y-2",children:[r.jsx(ge,{label:t,tone:e}),r.jsx("p",{className:"text-xs text-muted-foreground",children:a})]})]})}function N({title:t,children:e}){return r.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-4",children:[r.jsx("div",{className:"flex items-center justify-between",children:r.jsx("p",{className:"text-sm font-semibold text-foreground",children:t})}),r.jsx("div",{className:"mt-3 space-y-2 text-xs text-muted-foreground",children:e})]})}function we({items:t}){return r.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card/80 p-3",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Timeline"}),r.jsxs("span",{className:"text-xs text-muted-foreground",children:[t.length," steps"]})]}),r.jsx("div",{className:"mt-3 grid grid-cols-2 gap-2 sm:grid-cols-3 lg:grid-cols-1",children:t.map(e=>r.jsxs("div",{className:`flex items-center gap-2 rounded-xl border px-2.5 py-2 text-xs ${e.state==="completed"?"border-emerald-500/40 bg-emerald-500/10 text-emerald-100":e.state==="current"?"border-primary/50 bg-primary/10 text-primary-foreground":"border-border/60 bg-background/40 text-muted-foreground"}`,children:[r.jsx("div",{className:`flex h-5 w-5 items-center justify-center rounded-full text-[10px] font-semibold ${e.state==="completed"?"bg-emerald-500/80 text-emerald-950":e.state==="current"?"bg-primary/80 text-primary-foreground":"border border-border/70 text-muted-foreground"}`,children:e.state==="completed"?"âœ“":e.state==="current"?"â€¢":""}),r.jsx("p",{className:"text-xs font-medium",children:e.label})]},e.label))})]})}const S=new Date,C=new Date;C.setDate(S.getDate()+7);const n=[{id:"1",title:"My Crypto Channel",username:"mycryptocha",avatarUrl:"ðŸ“°",verified:!0,subscribers:45e3,averageViews:18e3,engagementRate:40,language:"EN",priceTon:2.5,description:"Verified creator channel ready for sponsor placements and crypto-native offers.",listing:{id:"listing-mock-1",channelId:"1",format:"POST",priceTon:2.5,availabilityFrom:S.toISOString(),availabilityTo:C.toISOString(),allowEdits:!0,requiresApproval:!0,contentRulesText:"Casino and betting promos allowed with approval.",tags:["Casino","Betting","iGaming","Crypto","English only"],isActive:!0,allowLinkTracking:!0,allowPinnedPlacement:!1}},{id:"ch-flow-1",title:"TON Launchpad",username:"tonlaunchpad",avatarUrl:"ðŸ›°ï¸",verified:!0,subscribers:182400,averageViews:72e3,engagementRate:38,language:"EN",priceTon:4.2,description:"Launch announcements and high-intent crypto audience with strong conversion rates.",listing:{id:"listing-mock-2",channelId:"ch-flow-1",format:"POST",priceTon:4.2,availabilityFrom:S.toISOString(),availabilityTo:C.toISOString(),allowEdits:!1,requiresApproval:!0,contentRulesText:"Betting partners only. No adult content.",tags:["Betting","Sports","Finance","Promo codes","No NSFW"],isActive:!0,allowLinkTracking:!0,allowPinnedPlacement:!1}},{id:"ch-flow-2",title:"Crypto Atlas",username:"cryptoatlas",avatarUrl:"ðŸ§­",verified:!0,subscribers:134900,averageViews:54500,engagementRate:34,language:"EN",priceTon:3.5,description:"Daily market maps, token watchlists, and launch alerts for Web3 founders."},{id:"ch-flow-3",title:"Founder Notes",username:"foundernotes",avatarUrl:"ðŸ“",verified:!0,subscribers:96200,averageViews:29400,engagementRate:32,language:"EN",priceTon:2.6,description:"Product builders, startup advice, and weekly spotlight features."},{id:"ch-flow-4",title:"Signal Stream",username:"signalstream",avatarUrl:"ðŸ“¡",verified:!0,subscribers:210800,averageViews:89e3,engagementRate:41,language:"EN",priceTon:5.1,description:"High-frequency trading insights with global reach and premium placement slots."},{id:"ch-flow-5",title:"Web3 Horizon",username:"web3horizon",avatarUrl:"ðŸŒ…",verified:!0,subscribers:118700,averageViews:46e3,engagementRate:29,language:"EN",priceTon:3.1,description:"Community-first Web3 news with high loyalty and repeat engagement."},{id:"ch-flow-6",title:"Finansy ÐÐ¾Ð²Ð¾ÑÑ‚Ð¸",username:"finansy_ru",avatarUrl:"ðŸ’¹",verified:!0,subscribers:165500,averageViews:63500,engagementRate:36,language:"RU",priceTon:3.8,description:"Russian finance digest with premium reach across fintech and crypto segments."}],T="flowgramx.mockDeals",R=Date.now(),i=t=>new Date(R-t*6e4).toISOString(),q=t=>new Date(R+t*6e4).toISOString(),he=t=>new Date(R+t*36e5).toISOString(),v=[{id:"DL-2001",status:"OWNER_ACCEPTED",updatedAt:i(8),priceTon:4.2,briefText:"Launch teaser for FlowgramX with CTA to beta waitlist.",channel:{id:n[0].id,title:n[0].title,username:n[0].username,avatarUrl:n[0].avatarUrl,isVerified:n[0].verified,subscribers:n[0].subscribers,averageViews:n[0].averageViews,language:n[0].language,priceTon:n[0].priceTon},escrow:{status:"AWAITING_PAYMENT",amountTon:4.2,network:"TON",depositAddress:"EQC2MockDepositAddress1111",memo:"FGX-2001",updatedAt:i(8)}},{id:"DL-2002",status:"CREATIVE_SUBMITTED",updatedAt:i(18),priceTon:3.5,briefText:"Promote new campaign dashboard with a short CTA to try demo.",channel:{id:n[1].id,title:n[1].title,username:n[1].username,avatarUrl:n[1].avatarUrl,isVerified:n[1].verified,subscribers:n[1].subscribers,averageViews:n[1].averageViews,language:n[1].language,priceTon:n[1].priceTon},escrow:{status:"FUNDS_LOCKED",amountTon:3.5,network:"TON",updatedAt:i(20)},creative:{text:"ðŸš€ FlowgramX just launched a smarter way to buy Telegram placements. Try the demo today.",submittedAt:i(18),approvedAt:null}},{id:"DL-2003",status:"SCHEDULED",updatedAt:i(40),priceTon:2.6,briefText:"Drive signups for creator waitlist with emphasis on verified channels.",channel:{id:n[2].id,title:n[2].title,username:n[2].username,avatarUrl:n[2].avatarUrl,isVerified:n[2].verified,subscribers:n[2].subscribers,averageViews:n[2].averageViews,language:n[2].language,priceTon:n[2].priceTon},escrow:{status:"FUNDS_LOCKED",amountTon:2.6,network:"TON",updatedAt:i(40)},creative:{text:"FlowgramX connects advertisers with top Telegram channels. Join the waitlist today.",submittedAt:i(60),approvedAt:i(48)},schedule:{scheduledAt:he(2),timezone:"UTC"}},{id:"DL-2004",status:"POSTED",updatedAt:i(6),priceTon:5.1,briefText:"Highlight escrow safety and bot-assisted messaging for advertisers.",channel:{id:n[3].id,title:n[3].title,username:n[3].username,avatarUrl:n[3].avatarUrl,isVerified:n[3].verified,subscribers:n[3].subscribers,averageViews:n[3].averageViews,language:n[3].language,priceTon:n[3].priceTon},escrow:{status:"FUNDS_LOCKED",amountTon:5.1,network:"TON",updatedAt:i(8)},creative:{text:"FlowgramX keeps your TON safe in escrow until the post is verified. Learn more today.",submittedAt:i(35),approvedAt:i(30)},schedule:{scheduledAt:i(15),timezone:"UTC"},post:{messageId:"99421",viewUrl:"https://t.me/signalstream/99421",verifyUntil:q(22),postedAt:i(12)}},{id:"DL-2005",status:"RELEASED",updatedAt:i(55),priceTon:3.1,briefText:"Showcase creative review and scheduling in the mini app.",channel:{id:n[4].id,title:n[4].title,username:n[4].username,avatarUrl:n[4].avatarUrl,isVerified:n[4].verified,subscribers:n[4].subscribers,averageViews:n[4].averageViews,language:n[4].language,priceTon:n[4].priceTon},escrow:{status:"RELEASED",amountTon:3.1,network:"TON",updatedAt:i(55)},creative:{text:"Our first FlowgramX campaign is live â€” thanks to the community!",submittedAt:i(120),approvedAt:i(110)},schedule:{scheduledAt:i(90),timezone:"UTC"},post:{messageId:"99400",viewUrl:"https://t.me/web3horizon/99400",verifyUntil:i(10),postedAt:i(80)}},{id:"DL-2006",status:"REFUNDED",updatedAt:i(90),priceTon:3.8,briefText:"Russian audience campaign for product launch update.",channel:{id:n[5].id,title:n[5].title,username:n[5].username,avatarUrl:n[5].avatarUrl,isVerified:n[5].verified,subscribers:n[5].subscribers,averageViews:n[5].averageViews,language:n[5].language,priceTon:n[5].priceTon},escrow:{status:"REFUNDED",amountTon:3.8,network:"TON",updatedAt:i(90)}}],G=()=>typeof window<"u"&&!!window.localStorage,W=()=>{if(!G())return[...v];const t=window.localStorage.getItem(T);if(!t)return window.localStorage.setItem(T,JSON.stringify(v)),[...v];try{const e=JSON.parse(t);if(Array.isArray(e)&&e.length>0)return e}catch(e){console.warn("Failed to parse mock deals",e)}return window.localStorage.setItem(T,JSON.stringify(v)),[...v]},ye=t=>{G()&&window.localStorage.setItem(T,JSON.stringify(t))},be=t=>W().find(e=>e.id===t)??null,h=(t,e)=>{const s=W(),o=s.findIndex(y=>y.id===t);if(o===-1)return null;const d=e({...s[o]});return s[o]=d,ye(s),d},ve=t=>h(t,e=>{const s=new Date().toISOString(),o=!!e.schedule?.scheduledAt;return{...e,status:o?"SCHEDULED":"CREATIVE_APPROVED",updatedAt:s,creative:{...e.creative,approvedAt:s}}}),Ee=(t,e)=>h(t,s=>{const o=new Date().toISOString();return{...s,status:"CREATIVE_DRAFTING",updatedAt:o,creative:{...s.creative,text:e?`${s.creative?.text??""}

Edits: ${e}`.trim():s.creative?.text,submittedAt:null,approvedAt:null,lastUpdatedAt:o}}}),Ne=t=>h(t,e=>{const s=new Date().toISOString();return e.escrow?.status==="AWAITING_PAYMENT"?{...e,status:"PAYMENT_CONFIRMING",updatedAt:s,escrow:{...e.escrow,status:"PAYMENT_CONFIRMING",updatedAt:s}}:e.escrow?.status==="PAYMENT_CONFIRMING"?{...e,status:"FUNDS_LOCKED",updatedAt:s,escrow:{...e.escrow,status:"FUNDS_LOCKED",updatedAt:s},creative:e.creative??{text:"",submittedAt:null,approvedAt:null}}:{...e,updatedAt:s}}),Te=t=>h(t,e=>{const s=new Date().toISOString();return{...e,status:"POSTED",updatedAt:s,post:{messageId:"10101",viewUrl:`https://t.me/${e.channel.username}/10101`,verifyUntil:q(25),postedAt:s}}}),Ae=t=>h(t,e=>{const s=new Date().toISOString();return{...e,status:"RELEASED",updatedAt:s,escrow:e.escrow?{...e.escrow,status:"RELEASED",updatedAt:s}:void 0}}),De=t=>h(t,e=>{const s=new Date().toISOString();return{...e,status:"REFUNDED",updatedAt:s,escrow:e.escrow?{...e.escrow,status:"REFUNDED",updatedAt:s}:void 0}}),Se=!0,p=async(t=300,e=600)=>{const s=Math.floor(Math.random()*(e-t+1))+t;await new Promise(o=>setTimeout(o,s))};console.info("MOCK MODE ENABLED for Deals");const Ce=async t=>{{await p();const e=be(t);if(!e)throw new Error("Deal not found");return e}},Re=async t=>{{await p();const e=ve(t);if(!e)throw new Error("Deal not found");return e}},Ie=async(t,e)=>{{await p();const s=Ee(t,e);if(!s)throw new Error("Deal not found");return s}},je=async t=>{await p();const e=Ne(t);if(!e)throw new Error("Deal not found");return e},Pe=async t=>{await p();const e=Te(t);if(!e)throw new Error("Deal not found");return e},Ve=async t=>{await p();const e=Ae(t);if(!e)throw new Error("Deal not found");return e},Ue=async t=>{await p();const e=De(t);if(!e)throw new Error("Deal not found");return e},Fe=t=>{const e=Date.now()-new Date(t).getTime(),s=Math.max(1,Math.round(e/6e4));if(s<60)return`Updated ${s}m ago`;const o=Math.round(s/60);return o<24?`Updated ${o}h ago`:`Updated ${Math.round(o/24)}d ago`},Me=t=>{if(!t)return"Waiting for scheduling";const e=new Date(t);return`${e.toLocaleDateString("en-US",{month:"short",day:"numeric"})} Â· ${e.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})}`},Oe=t=>{if(!t)return null;const e=new Date(t).getTime()-Date.now();return`${Math.max(0,Math.round(e/6e4))}m`},ke={REQUESTED:{label:"Request sent",description:"Your request is with the channel owner. We'll notify you via bot once accepted.",ctaLabel:"View request",listAction:"View",category:"pending",tone:"neutral"},PAYMENT_REQUIRED:{label:"Payment required",description:"Escrow keeps funds safe until the post is verified.",ctaLabel:"Pay escrow",listAction:"Pay Now",category:"pending",tone:"warning"},PAYMENT_CONFIRMING:{label:"Payment confirming",description:"We're confirming your TON transfer. This usually takes a minute.",ctaLabel:"View payment",listAction:"View",category:"pending",tone:"info"},FUNDS_LOCKED:{label:"Funds locked",description:"Funds are secured in escrow while the channel drafts your creative.",ctaLabel:"Message via bot",listAction:"View",category:"active",tone:"info"},CREATIVE_DRAFTING:{label:"Creative drafting",description:"The channel owner is preparing the creative draft for your review.",ctaLabel:"Message via bot",listAction:"View",category:"active",tone:"info"},CREATIVE_REVIEW:{label:"Creative review",description:"Review the draft and approve to schedule delivery.",ctaLabel:"Review creative",listAction:"Review",category:"active",tone:"primary"},CREATIVE_APPROVED:{label:"Creative approved",description:"Creative approved. Waiting for channel to schedule the post.",ctaLabel:"View status",listAction:"View",category:"active",tone:"info"},SCHEDULED:{label:"Scheduled",description:"The post is scheduled and queued for delivery.",ctaLabel:"View schedule",listAction:"View",category:"active",tone:"info"},VERIFYING:{label:"Posted Â· verifying",description:"Post is live. Verification checks will release escrow automatically.",ctaLabel:"View post",listAction:"View Post",category:"active",tone:"primary"},RELEASED:{label:"Released",description:"Post verified. Escrow released to the channel owner.",ctaLabel:"View receipt",listAction:"Receipt",category:"completed",tone:"success"},REFUNDED:{label:"Refunded",description:"Verification failed or the deal was cancelled. Funds returned.",ctaLabel:"View receipt",listAction:"Receipt",category:"completed",tone:"danger"}},Q=t=>t.status==="REFUNDED"||t.escrow?.status==="REFUNDED"?"REFUNDED":t.status==="RELEASED"||t.escrow?.status==="RELEASED"?"RELEASED":t.status==="VERIFYING"||t.status==="POSTED"||t.post?.viewUrl?"VERIFYING":t.status==="SCHEDULED"||t.schedule?.scheduledAt?"SCHEDULED":t.status==="CREATIVE_SUBMITTED"&&!t.creative?.approvedAt?"CREATIVE_REVIEW":t.status==="CREATIVE_APPROVED"||t.creative?.approvedAt?"CREATIVE_APPROVED":t.status==="CREATIVE_DRAFTING"?"CREATIVE_DRAFTING":t.status==="FUNDS_LOCKED"||t.escrow?.status==="FUNDS_LOCKED"?"FUNDS_LOCKED":t.status==="PAYMENT_CONFIRMING"||t.escrow?.status==="PAYMENT_CONFIRMING"?"PAYMENT_CONFIRMING":t.status==="PAYMENT_REQUIRED"||t.status==="OWNER_ACCEPTED"||t.escrow?.status==="AWAITING_PAYMENT"?"PAYMENT_REQUIRED":"REQUESTED",Le=t=>{const e=Q(t);return ke[e]},_e=["Accepted","Payment","Creative","Scheduled","Posted","Released"],qe={REQUESTED:0,PAYMENT_REQUIRED:1,PAYMENT_CONFIRMING:1,FUNDS_LOCKED:2,CREATIVE_DRAFTING:2,CREATIVE_REVIEW:2,CREATIVE_APPROVED:3,SCHEDULED:3,VERIFYING:4,RELEASED:5,REFUNDED:5},Ge=t=>{const e=Q(t),s=qe[e];return _e.map((o,d)=>d<s?{label:o,state:"completed"}:d===s?{label:o,state:"current"}:{label:o,state:"upcoming"})},c={all:["deals"],list:t=>["deals","list",t],detail:t=>["deals","detail",t]},We=t=>le({queryKey:t?c.detail(t):c.detail("unknown"),queryFn:()=>{if(!t)throw new Error("Missing deal ID");return Ce(t)},enabled:!!t}),Qe=()=>{const t=x();return w({mutationFn:e=>Re(e),onSuccess:e=>{t.invalidateQueries({queryKey:c.all}),t.setQueryData(c.detail(e.id),e),l.success("Creative approved")},onError:e=>{l.error(u(e,"Unable to approve creative"))}})},Ye=()=>{const t=x();return w({mutationFn:({id:e,note:s})=>Ie(e,s),onSuccess:e=>{t.invalidateQueries({queryKey:c.all}),t.setQueryData(c.detail(e.id),e),l.success("Edits requested")},onError:e=>{l.error(u(e,"Unable to request edits"))}})},Ke=()=>{const t=x();return w({mutationFn:e=>je(e),onSuccess:e=>{t.invalidateQueries({queryKey:c.all}),t.setQueryData(c.detail(e.id),e),l.success("Payment confirmed")},onError:e=>{l.error(u(e,"Unable to process payment"))}})},$e=()=>{const t=x();return w({mutationFn:e=>Pe(e),onSuccess:e=>{t.invalidateQueries({queryKey:c.all}),t.setQueryData(c.detail(e.id),e),l.success("Post published")},onError:e=>{l.error(u(e,"Unable to simulate post"))}})},ze=()=>{const t=x();return w({mutationFn:e=>Ve(e),onSuccess:e=>{t.invalidateQueries({queryKey:c.all}),t.setQueryData(c.detail(e.id),e),l.success("Escrow released")},onError:e=>{l.error(u(e,"Unable to simulate release"))}})},He=()=>{const t=x();return w({mutationFn:e=>Ue(e),onSuccess:e=>{t.invalidateQueries({queryKey:c.all}),t.setQueryData(c.detail(e.id),e),l.success("Deal refunded")},onError:e=>{l.error(u(e,"Unable to simulate refund"))}})};function nt(){const{dealId:t}=re(),[e,s]=E.useState(!1),[o,d]=E.useState(!1),y=se(),[A]=ae(),{open:f}=ne(),{data:a,isLoading:Y,error:I,refetch:K}=We(t),j=Qe(),P=Ye(),V=Ke(),U=$e(),F=ze(),M=He(),g=e||j.isPending||P.isPending||V.isPending||U.isPending||F.isPending||M.isPending,b=E.useMemo(()=>a?Le(a):null,[a]),$=E.useMemo(()=>a?Ge(a):[],[a]),O=Oe(a?.post?.verifyUntil),z=async()=>{if(a){s(!0);try{await j.mutateAsync(a.id)}finally{s(!1)}}},H=async()=>{if(a){s(!0);try{await P.mutateAsync({id:a.id,note:"Please tweak the CTA and shorten the headline."})}finally{s(!1)}}},B=async()=>{if(!a)return;const m=a.escrow?.depositAddress;if(!m){l.error("Payment address is missing");return}const D=a.escrow?.amountTon??a.priceTon;if(!Number.isFinite(D)||D<=0){l.error("Payment amount is invalid");return}if(!y){f(),l.info("Connect a TON wallet to continue");return}s(!0);try{await A.sendTransaction(oe({address:m,amountTon:D})),Se&&await V.mutateAsync(a.id)}catch(ee){l.error(u(ee,"Unable to process payment"))}finally{s(!1)}},X=async()=>{if(a){s(!0);try{await U.mutateAsync(a.id)}finally{s(!1)}}},J=async()=>{if(a){s(!0);try{await F.mutateAsync(a.id)}finally{s(!1)}}},Z=async()=>{if(a){s(!0);try{await M.mutateAsync(a.id)}finally{s(!1)}}},k=async m=>{m&&(await navigator.clipboard.writeText(m),l.success("Copied to clipboard"))};return r.jsx("div",{className:"w-full max-w-2xl mx-auto",children:r.jsx("div",{className:"px-4 py-6 space-y-4",children:Y?r.jsx(ce,{items:3}):I||!a||!b?r.jsx(de,{message:u(I,"Deal not found"),description:"We couldn't load this deal right now.",onRetry:()=>K()}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"grid gap-4 lg:grid-cols-[minmax(0,1fr)_240px] lg:items-start",children:[r.jsx(xe,{status:b.label,tone:b.tone,title:a.channel.title,username:a.channel.username,verified:a.channel.isVerified,price:`${a.priceTon} TON`,dealId:a.id,avatarUrl:a.channel.avatarUrl,statusDescription:b.description}),r.jsx(we,{items:$})]}),r.jsxs(N,{title:"Escrow",children:[r.jsxs("div",{className:"flex items-center justify-between text-sm text-foreground",children:[r.jsx("span",{children:a.escrow?.status??"Awaiting payment"}),r.jsxs("span",{className:"font-semibold",children:[a.escrow?.amountTon??a.priceTon," TON"]})]}),r.jsx("p",{className:"text-xs text-muted-foreground",children:"Escrow holds funds safely until the post is verified."}),a.escrow?.status==="AWAITING_PAYMENT"?r.jsxs("div",{className:"mt-4 space-y-3",children:[r.jsx("button",{type:"button",onClick:B,disabled:g,className:"inline-flex w-full items-center justify-center rounded-xl bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground disabled:pointer-events-none disabled:opacity-70",children:"Pay via Telegram Wallet"}),r.jsx("a",{href:a.escrow.depositAddress?ie({address:a.escrow.depositAddress,amountTon:a.escrow.amountTon,memo:a.escrow.memo}):void 0,className:"inline-flex w-full items-center justify-center rounded-xl border border-border/60 px-4 py-2 text-xs font-semibold text-foreground",children:"Open TON transfer link"}),r.jsxs("button",{type:"button",onClick:()=>d(m=>!m),className:"w-full rounded-xl border border-border/60 px-4 py-2 text-sm text-foreground",children:[o?"Hide":"Show"," manual transfer"]}),o?r.jsxs("div",{className:"space-y-2 rounded-xl border border-border/60 bg-background p-3 text-xs text-muted-foreground",children:[r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Address"}),r.jsx("button",{type:"button",onClick:()=>k(a.escrow?.depositAddress),children:r.jsx(L,{size:14})})]}),r.jsx("p",{className:"break-all text-foreground",children:a.escrow?.depositAddress??"-"}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsx("span",{children:"Memo"}),r.jsx("button",{type:"button",onClick:()=>k(a.escrow?.memo),children:r.jsx(L,{size:14})})]}),r.jsx("p",{className:"text-foreground",children:a.escrow?.memo??"-"})]}):null,r.jsx("p",{className:"text-xs text-muted-foreground",children:"Mock payments confirm after the wallet approval flow."})]}):null,r.jsx("div",{className:"mt-3 text-[11px] text-muted-foreground",children:Fe(a.updatedAt)})]}),r.jsxs(N,{title:"Creative",children:[r.jsx("p",{className:"text-sm font-semibold text-foreground",children:a.creative?.submittedAt?a.creative.approvedAt?"Approved":"Needs your review":"Waiting for channel owner"}),r.jsx("p",{className:"text-sm text-muted-foreground",children:a.creative?.text??"Creative will appear here once submitted."}),a.creative?.submittedAt&&!a.creative?.approvedAt?r.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[r.jsx("button",{type:"button",onClick:z,disabled:g,className:"rounded-full bg-primary px-4 py-2 text-xs font-semibold text-primary-foreground",children:"Approve"}),r.jsx("button",{type:"button",onClick:H,disabled:g,className:"rounded-full border border-border/60 px-4 py-2 text-xs text-foreground",children:"Request edits"})]}):r.jsx("p",{className:"mt-3 text-[11px] text-muted-foreground",children:"Approvals are confirmed via bot messaging."})]}),r.jsxs(N,{title:"Schedule",children:[r.jsx("p",{className:"text-sm text-foreground",children:Me(a.schedule?.scheduledAt)}),r.jsxs("p",{className:"text-xs text-muted-foreground",children:["Timezone: ",a.schedule?.timezone??"UTC"]})]}),r.jsxs(N,{title:"Delivery",children:[r.jsx("p",{className:"text-sm text-foreground",children:a.post?.viewUrl?"Post live":"Waiting for delivery"}),a.post?.viewUrl?r.jsxs("a",{href:a.post.viewUrl,target:"_blank",rel:"noreferrer",className:"mt-2 inline-flex items-center gap-2 text-xs text-primary",children:[r.jsx(pe,{size:12})," View in Telegram"]}):null,r.jsx("p",{className:"mt-2 text-xs text-muted-foreground",children:O?`Release in: ${O}`:"Verification pending"}),r.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[r.jsx("button",{type:"button",onClick:X,disabled:g,className:"rounded-full border border-border/60 px-3 py-1 text-xs",children:"Simulate Post Published"}),r.jsx("button",{type:"button",onClick:J,disabled:g,className:"rounded-full border border-border/60 px-3 py-1 text-xs",children:"Simulate Verify Pass"}),r.jsx("button",{type:"button",onClick:Z,disabled:g,className:"rounded-full border border-border/60 px-3 py-1 text-xs",children:"Simulate Verify Fail"})]})]}),r.jsx("div",{className:"sticky bottom-4 rounded-2xl border border-border/60 bg-card/90 px-4 py-3 backdrop-blur",children:r.jsx("button",{type:"button",className:"w-full rounded-xl bg-primary px-4 py-2 text-sm font-semibold text-primary-foreground",children:b.ctaLabel})})]})})})}export{nt as default};
