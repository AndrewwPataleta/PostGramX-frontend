import{u as c}from"./useQuery-CNVja9lc.js";import{p as s,f as l,e as o,u as n,g as r}from"./index-B5wV3xWl.js";import{u}from"./useMutation-Do8kPxLD.js";const a=e=>({items:Array.isArray(e?.items)?e?.items:[],page:typeof e?.page=="number"?e.page:1,limit:typeof e?.limit=="number"?e.limit:10,total:typeof e?.total=="number"?e.total:0}),d=async e=>s("/deals/create",e),m=async(e={})=>{const i={role:e.role??"all",pendingPage:e.pendingPage,pendingLimit:e.pendingLimit,activePage:e.activePage,activeLimit:e.activeLimit,completedPage:e.completedPage,completedLimit:e.completedLimit},t=await s("/deals/list",i);return{pending:a(t.pending),active:a(t.active),completed:a(t.completed)}},f=e=>c({queryKey:["deals",e.role??"all",e.pendingPage??1,e.activePage??1,e.completedPage??1],queryFn:()=>m(e),staleTime:2e4,refetchOnWindowFocus:!1}),v=()=>{const e=l(),i=o();return u({mutationFn:t=>d(t),onSuccess:()=>{n.success("Deal created"),r()?.HapticFeedback?.notificationOccurred?.("success"),e.invalidateQueries({queryKey:["deals"]}),i("/deals",{state:{activeTab:"pending"},replace:!0})},onError:t=>{n.error(t.message)}})};export{f as a,v as u};
