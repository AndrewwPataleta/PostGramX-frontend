import{E as N,F as P,G as w,c as p,j as e,L as f,a as E,H as k,I as R,r as x,o as C,J as M}from"./index-_r0t-zdo.js";import{Q as F,u as D,g as j,E as L,S as i}from"./errors-C9-KVE9g.js";import{P as A}from"./plus-CVOSglLp.js";var I=class extends F{constructor(s,t){super(s,t)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(s){super.setOptions({...s,behavior:N()})}getOptimisticResult(s){return s.behavior=N(),super.getOptimisticResult(s)}fetchNextPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(s){return this.fetch({...s,meta:{fetchMore:{direction:"backward"}}})}createResult(s,t){const{state:n}=s,o=super.createResult(s,t),{isFetching:m,isRefetching:g,isError:h,isRefetchError:d}=o,a=n.fetchMeta?.fetchMore?.direction,u=h&&a==="forward",c=m&&a==="forward",l=h&&a==="backward",r=m&&a==="backward";return{...o,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:w(t,n.data),hasPreviousPage:P(t,n.data),isFetchNextPageError:u,isFetchingNextPage:c,isFetchPreviousPageError:l,isFetchingPreviousPage:r,isRefetchError:d&&!u&&!l,isRefetching:g&&!c&&!r}}};function T(s,t){return D(s,I)}/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],V=p("badge-check",S);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],O=p("shield",_);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M18 21a8 8 0 0 0-16 0",key:"3ypg7q"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"M22 20c0-3.37-2-6.5-4-8a5 5 0 0 0-.45-8.3",key:"10s06x"}]],Q=p("users-round",z),U={DRAFT:{label:"Draft",className:"bg-muted/40 text-muted-foreground border-border/60"},PENDING_VERIFY:{label:"Pending verification",className:"bg-yellow-500/20 text-yellow-300 border-yellow-500/40"},VERIFIED:{label:"Verified",className:"bg-emerald-500/15 text-emerald-300 border-emerald-500/30",icon:e.jsx(V,{size:12,className:"text-emerald-300"})},FAILED:{label:"Verification failed",className:"bg-red-500/20 text-red-300 border-red-500/40"},REVOKED:{label:"Revoked",className:"bg-orange-500/20 text-orange-300 border-orange-500/40"}},y=s=>s==null?"â€“":s>=1e6?`${(s/1e6).toFixed(1)}M`:s>=1e3?`${(s/1e3).toFixed(1)}K`:s.toString(),$=s=>s||"Untitled channel",v=({channel:s})=>{const t=U[s.status];return e.jsxs(f,{to:`/channel-manage/${s.id}`,className:"block rounded-2xl border border-border/50 bg-card/80 p-4 shadow-sm transition hover:border-border/80 hover:bg-card",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:$(s.title)}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["@",s.username]})]}),e.jsxs("span",{className:E("inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-medium",t.className),children:[t.icon,t.label]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"rounded-xl bg-muted/30 p-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(Q,{size:12}),"Members"]}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-foreground",children:y(s.memberCount)})]}),e.jsxs("div",{className:"rounded-xl bg-muted/30 p-3",children:[e.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[e.jsx(O,{size:12}),"Avg. Views"]}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-foreground",children:y(s.avgViews)})]}),e.jsxs("div",{className:"rounded-xl bg-muted/30 p-3",children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Role"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-foreground",children:s.membership.role})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{className:"uppercase tracking-wide",children:s.membership.telegramAdminStatus}),e.jsxs("span",{className:"text-[11px] text-muted-foreground/80",children:["Last checked ",s.lastCheckedAt?new Date(s.lastCheckedAt).toLocaleDateString():"â€“"]})]})]})},K=(s,t)=>({...t,data:s}),q=()=>{const s=k()?.initData;if(!s)throw new Error("Telegram init data is missing.");return{platformType:"telegram",authType:"telegram",token:s}},B=async s=>{const t=q();return(await R.post("/channels/list",K(s,t))).data},G=s=>["channelsList",s],Y=(s,t=10)=>T({queryKey:G(s),queryFn:({pageParam:n=1})=>B({...s,page:Number(n),limit:t}),getNextPageParam:n=>n.hasNext?n.page+1:void 0,initialPageParam:1}),H="recent",J="desc",W=["DRAFT","PENDING_VERIFY","FAILED","REVOKED"],Z=()=>e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card/80 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"h-4 w-32"}),e.jsx(i,{className:"h-3 w-20"})]}),e.jsx(i,{className:"h-5 w-24 rounded-full"})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-3 gap-2",children:[e.jsx(i,{className:"h-16 rounded-xl"}),e.jsx(i,{className:"h-16 rounded-xl"}),e.jsx(i,{className:"h-16 rounded-xl"})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx(i,{className:"h-3 w-24"}),e.jsx(i,{className:"h-3 w-20"})]})]});function te(){const s=x.useMemo(()=>({sort:H,order:J}),[]),{data:t,isLoading:n,isFetchingNextPage:o,fetchNextPage:m,hasNextPage:g,refetch:h,error:d}=Y(s,10),a=x.useMemo(()=>t?.pages.flatMap(r=>r.items)??[],[t]),u=t?.pages?.[0]?.total??0;x.useEffect(()=>{d&&C.error(j(d,"Unable to load channels."))},[d]);const c=x.useMemo(()=>a.filter(r=>r.status==="VERIFIED"),[a]),l=x.useMemo(()=>a.filter(r=>W.includes(r.status)),[a]);return e.jsxs("div",{className:"mx-auto flex w-full max-w-2xl flex-col gap-6 px-4 pb-16 pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-base font-semibold text-foreground",children:"My Channels"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Manage your verified and pending channels."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[null,e.jsxs(f,{to:"/add-channel/step-1",className:"inline-flex items-center gap-2 rounded-full bg-primary px-3 py-2 text-xs font-semibold text-primary-foreground",children:[e.jsx(A,{size:14}),"Add Channel"]})]})]}),n?e.jsx("div",{className:"space-y-3",children:Array.from({length:3}).map((r,b)=>e.jsx(Z,{},`channel-skeleton-${b}`))}):d?e.jsx(L,{message:j(d,"Unable to load channels"),description:"Please try again in a moment.",onRetry:()=>h()}):a.length===0?e.jsxs("div",{className:"rounded-2xl border border-dashed border-border/60 bg-card/70 p-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-14 w-14 items-center justify-center rounded-full bg-primary/10 text-2xl",children:"ðŸ“¡"}),e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"No channels yet"}),e.jsx("p",{className:"mt-1 text-xs text-muted-foreground",children:"Connect your first Telegram channel to get started."}),e.jsx(f,{to:"/add-channel/step-1",className:"mt-4 inline-flex items-center justify-center rounded-full bg-primary px-4 py-2 text-xs font-semibold text-primary-foreground",children:"Add Channel"})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:[e.jsx("span",{children:"Pending"}),e.jsx("span",{children:l.length})]}),l.length>0?e.jsx("div",{className:"space-y-3",children:l.map(r=>e.jsx(v,{channel:r},r.id))}):e.jsx("p",{className:"rounded-xl border border-dashed border-border/60 bg-card/70 px-4 py-3 text-xs text-muted-foreground",children:"No pending channels right now."})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:[e.jsx("span",{children:"Verified"}),e.jsx("span",{children:c.length})]}),c.length>0?e.jsx("div",{className:"space-y-3",children:c.map(r=>e.jsx(v,{channel:r},r.id))}):e.jsx("p",{className:"rounded-xl border border-dashed border-border/60 bg-card/70 px-4 py-3 text-xs text-muted-foreground",children:"No verified channels yet."})]})]}),a.length>0?e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Showing ",a.length," of ",u]}),g?e.jsxs("button",{type:"button",onClick:()=>m(),disabled:o,className:"inline-flex items-center gap-2 rounded-full border border-border/60 bg-card/80 px-4 py-2 text-xs font-semibold text-foreground transition hover:bg-card",children:[o?e.jsx(M,{size:14,className:"animate-spin"}):null,o?"Loading":"Load more"]}):null]}):null]})}export{te as default};
