import{c as _,r as u,u as V,j as e,g as U,a as z,X as F,b as B}from"./index-K2Jj1BK-.js";import{u as q}from"./useQuery-BnM_P3Iz.js";import{l as G}from"./listingsApi-DvYXUwcq.js";import{S as C}from"./skeleton-DmOSyBhX.js";import{f as D,n as Q}from"./ton-ClBVV2oW.js";import{C as H}from"./check-DH6UOhjy.js";import{C as k}from"./chevron-down-DbEslXwk.js";import{f as X,l as W}from"./tagOptions-DoUmU6u5.js";import{E as J}from"./ErrorState-CZl5nE2W.js";import{g as K}from"./errors-3kY4UU5q.js";import{c as Y}from"./channelsApi-B3KNuCdD.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ee=_("search",Z);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],se=_("sliders-horizontal",re),P="Must be pre-approved",I=3,te=24,ae=5,ne=r=>{try{return BigInt(r)}catch{return null}},M=r=>r>=168&&r%24===0?`${r/24}d`:`${r}h`,oe=r=>{try{return D(Q(r))}catch{return r}},le=r=>{const o=r.map(a=>a.trim()).filter(a=>a.length>0&&a.length<=te),x=o.filter(a=>a.toLowerCase()===P.toLowerCase()),l=o.filter(a=>a.toLowerCase()!==P.toLowerCase()),y=Array.from(new Set([...x,...l]));return{visible:y.slice(0,I),hiddenCount:Math.max(y.length-I,0)}},ie=r=>{const o=[...r.allowEdits?["Edits allowed"]:[],...r.allowLinkTracking?["Tracking allowed"]:[],...r.allowPinnedPlacement||r.pinDurationHours!==null?["Pinned available"]:[]];return o.length===0?["Standard placement"]:o},ce=r=>[...r.requiresApproval?["Pre-approval required"]:[],`Pinned: ${r.pinDurationHours?M(r.pinDurationHours):"none"}`,`Visible: ${M(r.visibilityDurationHours)}`];function de({channel:r}){const[o,x]=u.useState(!1),[l,y]=u.useState(!1),a=V(),d=r.username?.replace(/^@/,""),j=d?`https://t.me/${d}`:null,v=Array.isArray(r.listings),i=q({queryKey:["marketplaceListingsByChannel",r.id],queryFn:()=>G({channelId:r.id,page:1,limit:ae,onlyActive:!0,sort:"price_asc"}),enabled:o&&!v,staleTime:1e3*60*5,refetchOnMount:!1}),R=i.data?.items??r.listings??[],b=v?r.listings:i.data?.items,S=b?.filter(n=>n.isActive!==!1),w=u.useMemo(()=>i.data?i.data.total??i.data.items.length:b?S?.length??0:null,[S?.length,i.data,b]),g=u.useMemo(()=>!b||b.length===0?null:b.reduce((n,c)=>{if(c.isActive===!1)return n;const h=ne(c.priceNano);return h===null?n:n===null||h<n?h:n},null),[b]),A=g?D(Q(g)):null,L=typeof r.subscribers=="number"?`${r.subscribers.toLocaleString()} subscribers`:"— subscribers",O=r.name?.[0]?.toUpperCase()??r.username?.[0]?.toUpperCase(),f=r.username?`@${r.username}`:null,T=!l&&r.avatarUrl?r.avatarUrl:null;return e.jsxs("div",{className:"rounded-2xl border border-border/50 bg-card/80 p-4 transition-colors hover:border-primary/40 cursor-pointer",role:"button",tabIndex:0,onClick:()=>a(`/channels/${r.id}`,{state:{channel:r,rootBackTo:"/marketplace"}}),onKeyDown:n=>{(n.key==="Enter"||n.key===" ")&&(n.preventDefault(),a(`/channels/${r.id}`,{state:{channel:r,rootBackTo:"/marketplace"}}))},children:[e.jsxs("div",{className:"flex items-start gap-3",children:[T?e.jsx("img",{src:T,alt:r.name,className:"h-12 w-12 rounded-full object-cover",onError:()=>y(!0)}):e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-primary/30 via-secondary/50 to-secondary text-lg text-foreground",children:O??"?"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:r.name}),r.verified?e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-primary/20 p-1",children:e.jsx(H,{size:12,className:"text-primary"})}):null]}),f?e.jsx("span",{className:"text-xs text-muted-foreground",children:f}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[j?e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation();const c=U();if(c?.openTelegramLink){c.openTelegramLink(j);return}window.open(j,"_blank","noopener,noreferrer")},className:"rounded-full border border-border/60 bg-secondary/40 px-3 py-1 text-[11px] font-semibold text-primary transition hover:text-primary/90",children:"Open channel"}):null,e.jsx("button",{type:"button",onClick:n=>{n.stopPropagation(),x(c=>!c)},"aria-expanded":o,className:"inline-flex h-8 w-8 items-center justify-center rounded-full border border-border/60 bg-secondary/40 text-muted-foreground transition hover:text-foreground",children:e.jsx(k,{size:16,className:z("transition-transform duration-200",o&&"rotate-180")})})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[e.jsx("span",{children:typeof w=="number"?`${w} placements`:"— placements"}),e.jsx("span",{children:"·"}),e.jsx("span",{children:L})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:e.jsxs("span",{children:["From ",e.jsxs("span",{className:"font-semibold text-primary",children:[A??"—"," TON"]})]})})]})]}),e.jsx("div",{className:z("overflow-hidden transition-all duration-300",o?"mt-4 max-h-[1200px] opacity-100":"max-h-0 opacity-0"),children:e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-background/60 p-3",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h4",{className:"text-xs font-semibold uppercase tracking-wide text-muted-foreground",children:"Placements"})}),i.isLoading?e.jsx("div",{className:"mt-3 space-y-3",children:Array.from({length:2}).map((n,c)=>e.jsxs("div",{className:"rounded-xl border border-border/50 bg-card/80 p-3",children:[e.jsx(C,{className:"h-4 w-24"}),e.jsx(C,{className:"mt-2 h-3 w-40"}),e.jsx(C,{className:"mt-2 h-3 w-28"})]},`listing-skeleton-${r.id}-${c}`))}):i.isError?e.jsx("div",{className:"mt-3 rounded-xl border border-border/60 bg-red-500/5 p-3 text-xs text-red-200",children:"Failed to load placements."}):R.length>0?e.jsx("div",{className:"mt-3 space-y-3",children:R.map(n=>{const c=le(n.tags??[]),h=ie(n),p=ce(n),N=n.contentRulesText?.trim();return e.jsxs("div",{className:"rounded-xl border border-border/60 bg-card/80 p-3",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[e.jsxs("span",{className:"text-sm font-semibold text-foreground",children:[oe(n.priceNano)," TON"]}),e.jsx("span",{className:"rounded-full border border-border/60 bg-muted/40 px-2 py-0.5 text-[10px] font-semibold text-muted-foreground",children:n.format}),n.isActive?e.jsx("span",{className:"rounded-full border border-emerald-500/40 bg-emerald-500/15 px-2 py-0.5 text-[10px] font-semibold text-emerald-300",children:"Active"}):null]}),c.visible.length>0?e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] text-foreground",children:[c.visible.map(s=>e.jsx("span",{className:z("rounded-full border px-2.5 py-1",s.toLowerCase()===P.toLowerCase()?"border-primary/40 bg-primary/10 text-primary":"border-border/60 bg-card text-foreground"),children:s},s)),c.hiddenCount>0?e.jsxs("span",{className:"rounded-full border border-border/60 bg-card px-2.5 py-1 text-muted-foreground",children:["+",c.hiddenCount]}):null]}):null,e.jsxs("div",{className:"mt-3 grid gap-3 text-[11px] text-muted-foreground sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-muted-foreground/80",children:"Allowed"}),e.jsx("div",{className:"mt-1 space-y-1",children:h.map(s=>e.jsx("p",{children:s},s))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-muted-foreground/80",children:"Requires"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[p.map(s=>e.jsx("p",{children:s},s)),N?e.jsxs("div",{className:"pt-1",children:[e.jsx("p",{className:"text-[10px] font-semibold uppercase tracking-wide text-muted-foreground/70",children:"Requirements"}),e.jsx("p",{className:"truncate text-[11px] text-muted-foreground",children:N})]}):null]})]})]})]},n.id)})}):e.jsx("div",{className:"mt-3 rounded-xl border border-dashed border-border/60 bg-card/60 p-4 text-center text-xs text-muted-foreground",children:"No placements available yet."})]})})]})}const ue=({filters:r,onRemoveFilter:o})=>r.priceRange[0]>0||r.priceRange[1]<10||r.subscribersRange[0]>0||r.subscribersRange[1]<1e6||r.languages.length>0||r.categories.length>0||r.tags.length>0||r.verifiedOnly?e.jsx("div",{className:"px-4 py-3 bg-secondary/30 border-b border-border/30 space-y-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[r.priceRange[0]>0||r.priceRange[1]<10?e.jsxs("button",{onClick:()=>o("priceRange"),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Price: ",r.priceRange[0].toFixed(1),"-",r.priceRange[1].toFixed(1)," TON",e.jsx(F,{size:14})]}):null,r.subscribersRange[0]>0||r.subscribersRange[1]<1e6?e.jsxs("button",{onClick:()=>o("subscribersRange"),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Subs: ",(r.subscribersRange[0]/1e3).toFixed(0),"K-",(r.subscribersRange[1]/1e3).toFixed(0),"K",e.jsx(F,{size:14})]}):null,r.verifiedOnly?e.jsxs("button",{onClick:()=>o("verifiedOnly"),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Verified Only",e.jsx(F,{size:14})]}):null,r.languages.map(l=>e.jsxs("button",{onClick:()=>o("languages",l),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[l,e.jsx(F,{size:14})]},l)),r.categories.map(l=>e.jsxs("button",{onClick:()=>o("categories",l),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[l,e.jsx(F,{size:14})]},l)),r.tags.map(l=>e.jsxs("button",{onClick:()=>o("tags",l),className:"inline-flex items-center gap-1.5 bg-secondary/70 hover:bg-secondary text-foreground px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[l,e.jsx(F,{size:14})]},l))]})}):null,xe=["EN","RU","ES","AR","DE","Other"],me=["Crypto","Finance","Gaming","Tech","Lifestyle","News"],ge=({isOpen:r,onClose:o,filters:x,onApply:l,onReset:y})=>{const[a,d]=u.useState(x),j=(s,t=1)=>new Intl.NumberFormat("en",{maximumFractionDigits:t}).format(s),v=s=>new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1}).format(s),[i,R]=u.useState({pricing:!0,audience:!0,language:!1,category:!1,tags:!1,availability:!1,verification:!1}),[b,S]=u.useState(""),[w,g]=u.useState(""),A=X(W),L=[{label:"Any",range:[0,10]},{label:"0-1 TON",range:[0,1]},{label:"1-5 TON",range:[1,5]},{label:"5-10 TON",range:[5,10]}],O=[{label:"Any",range:[0,1e6]},{label:"0-10K",range:[0,1e4]},{label:"10-100K",range:[1e4,1e5]},{label:"100K-1M",range:[1e5,1e6]}];u.useEffect(()=>{d(x)},[x,r]);const f=s=>{R(t=>({...t,[s]:!t[s]}))},T=(s,t)=>{const m=[...a.priceRange];m[s]=t,d(E=>({...E,priceRange:m}))},n=(s,t)=>{const m=[...a.subscribersRange];m[s]=t,d(E=>({...E,subscribersRange:m}))},c=s=>{d(t=>({...t,languages:t.languages.includes(s)?t.languages.filter(m=>m!==s):[...t.languages,s]}))},h=s=>{d(t=>({...t,categories:t.categories.includes(s)?t.categories.filter(m=>m!==s):[...t.categories,s]}))},p=()=>{l(a),o()},N=()=>{y(),d({priceRange:[0,10],subscribersRange:[0,1e6],languages:[],categories:[],tags:[],verifiedOnly:!1,dateRange:["",""]})};return r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:o}),e.jsxs("div",{className:"fixed inset-x-0 bottom-0 top-0 bg-card rounded-t-2xl z-50 animate-in slide-in-from-bottom-10 duration-300 flex flex-col h-[100dvh] sm:h-auto sm:top-auto sm:max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-card border-b border-border/50 px-4 py-4 flex items-center justify-between rounded-t-2xl shrink-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Filters"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-secondary rounded-lg transition-colors",children:e.jsx(F,{size:20,className:"text-foreground"})})]}),e.jsxs("div",{className:"px-4 py-4 space-y-4 flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f("pricing"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Pricing (TON)"}),e.jsx(k,{size:18,className:`text-muted-foreground transition-transform ${i.pricing?"rotate-180":""}`})]}),i.pricing&&e.jsxs("div",{className:"px-3 space-y-3 pb-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:L.map(s=>e.jsx("button",{onClick:()=>d(t=>({...t,priceRange:s.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${a.priceRange[0]===s.range[0]&&a.priceRange[1]===s.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s.label},s.label))}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:a.priceRange[0],onChange:s=>T(0,parseFloat(s.target.value)||0),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min"}),e.jsx("input",{type:"number",value:a.priceRange[1],onChange:s=>T(1,parseFloat(s.target.value)||10),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[j(a.priceRange[0])," -"," ",j(a.priceRange[1])," TON"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f("audience"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Audience"}),e.jsx(k,{size:18,className:`text-muted-foreground transition-transform ${i.audience?"rotate-180":""}`})]}),i.audience&&e.jsx("div",{className:"px-3 space-y-4 pb-3",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Subscribers"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:O.map(s=>e.jsx("button",{onClick:()=>d(t=>({...t,subscribersRange:s.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${a.subscribersRange[0]===s.range[0]&&a.subscribersRange[1]===s.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s.label},s.label))}),e.jsxs("div",{className:"flex flex-col gap-2 mb-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:a.subscribersRange[0],onChange:s=>n(0,parseInt(s.target.value)||0),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min"}),e.jsx("input",{type:"number",value:a.subscribersRange[1],onChange:s=>n(1,parseInt(s.target.value)||1e6),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[v(a.subscribersRange[0])," -"," ",v(a.subscribersRange[1])]})]})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f("language"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Language"}),e.jsx(k,{size:18,className:`text-muted-foreground transition-transform ${i.language?"rotate-180":""}`})]}),i.language&&e.jsx("div",{className:"px-3 pb-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:xe.map(s=>e.jsx("button",{onClick:()=>c(s),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${a.languages.includes(s)?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s},s))})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f("category"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Category"}),e.jsx(k,{size:18,className:`text-muted-foreground transition-transform ${i.category?"rotate-180":""}`})]}),i.category&&e.jsx("div",{className:"px-3 pb-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:me.map(s=>e.jsx("button",{onClick:()=>h(s),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${a.categories.includes(s)?"bg-accent text-accent-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s},s))})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f("tags"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Tags"}),e.jsx(k,{size:18,className:`text-muted-foreground transition-transform ${i.tags?"rotate-180":""}`})]}),i.tags&&e.jsxs("div",{className:"px-3 pb-3 space-y-3",children:[e.jsx("input",{type:"text",value:b,onChange:s=>S(s.target.value),placeholder:"Search tags",className:"w-full rounded-lg border border-border bg-input px-3 py-2 text-sm text-foreground"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:w,onChange:s=>g(s.target.value),placeholder:"Add custom tag",className:"flex-1 rounded-lg border border-border bg-input px-3 py-2 text-sm text-foreground"}),e.jsx("button",{type:"button",onClick:()=>{const s=w.trim();s&&(d(t=>({...t,tags:t.tags.includes(s)?t.tags:[...t.tags,s]})),g(""))},className:"rounded-lg border border-primary/40 bg-primary/10 px-3 py-2 text-xs font-semibold text-primary",children:"Add"})]}),a.tags.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tags.map(s=>e.jsxs("button",{type:"button",onClick:()=>d(t=>({...t,tags:t.tags.filter(m=>m!==s)})),className:"rounded-full bg-secondary px-3 py-1 text-xs text-foreground hover:bg-secondary/80",children:[s," ×"]},s))}):null,e.jsx("div",{className:"flex flex-wrap gap-2",children:A.filter(s=>s.toLowerCase().includes(b.trim().toLowerCase())).map(s=>{const t=a.tags.includes(s);return e.jsx("button",{type:"button",onClick:()=>d(m=>({...m,tags:t?m.tags.filter(E=>E!==s):[...m.tags,s]})),className:`rounded-full border px-3 py-1 text-xs transition-colors ${t?"border-primary/60 bg-primary/20 text-primary":"border-border/60 bg-card text-muted-foreground hover:text-foreground"}`,children:s},s)})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f("availability"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Availability"}),e.jsx(k,{size:18,className:`text-muted-foreground transition-transform ${i.availability?"rotate-180":""}`})]}),i.availability&&e.jsxs("div",{className:"px-3 pb-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"From date"}),e.jsx("input",{type:"date",value:a.dateRange[0],onChange:s=>d(t=>({...t,dateRange:[s.target.value,t.dateRange[1]]})),className:"w-full bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"To date"}),e.jsx("input",{type:"date",value:a.dateRange[1],onChange:s=>d(t=>({...t,dateRange:[t.dateRange[0],s.target.value]})),className:"w-full bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>f("verification"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Verification"}),e.jsx(k,{size:18,className:`text-muted-foreground transition-transform ${i.verification?"rotate-180":""}`})]}),i.verification&&e.jsx("div",{className:"px-3 pb-3",children:e.jsxs("label",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("input",{type:"checkbox",checked:a.verifiedOnly,onChange:s=>d(t=>({...t,verifiedOnly:s.target.checked})),className:"w-5 h-5 bg-secondary border border-border rounded accent-primary cursor-pointer"}),e.jsx("span",{className:"text-foreground font-medium",children:"Verified channels only"})]})})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-card border-t border-border/50 px-4 py-4 space-y-3",children:[e.jsx("button",{onClick:p,className:"button-primary w-full py-3 text-base font-semibold",children:"Apply Filters"}),e.jsx("button",{onClick:N,className:"button-secondary w-full py-3 text-base font-semibold",children:"Reset"})]})]})]}):null},$={priceRange:[0,100],subscribersRange:[0,1e6],languages:[],categories:[],tags:[],verifiedOnly:!0,dateRange:["",""]},pe={channels:r=>["channels",r]},be=()=>{const[r,o]=u.useState(""),[x,l]=u.useState(""),[y,a]=u.useState(!1),[d,j]=u.useState($),[v,i]=u.useState(1),[R]=u.useState(20),[b]=u.useState("recent"),[S]=u.useState("desc");u.useEffect(()=>{const c=window.setTimeout(()=>{l(r.trim())},300);return()=>{window.clearTimeout(c)}},[r]);const w=u.useMemo(()=>({q:x||void 0,verifiedOnly:d.verifiedOnly||void 0,page:v,limit:R,sort:b,order:S,includeListings:!1}),[x,d.verifiedOnly,R,S,v,b]),g=q({queryKey:pe.channels(w),queryFn:()=>Y.listChannels(w)});u.useEffect(()=>{g.error&&B.error(K(g.error,"Unable to load channels"))},[g.error]);const A=u.useMemo(()=>g.data?.items??[],[g.data?.items]),L=(c,h)=>{j(p=>{switch(c){case"priceRange":return{...p,priceRange:$.priceRange};case"subscribersRange":return{...p,subscribersRange:$.subscribersRange};case"verifiedOnly":return{...p,verifiedOnly:!1};case"languages":return{...p,languages:p.languages.filter(N=>N!==h)};case"categories":return{...p,categories:p.categories.filter(N=>N!==h)};case"tags":return{...p,tags:p.tags.filter(N=>N!==h)};default:return p}})},O=()=>a(!0),f=()=>a(!1),T=c=>j(c),n=()=>j($);return{state:{searchQuery:r,isFilterOpen:y,filters:d,isLoading:g.isLoading,error:g.error},computed:{channels:A},actions:{setSearchQuery:o,openFilters:O,closeFilters:f,applyFilters:T,resetFilters:n,removeFilter:L,refetch:()=>g.refetch(),setPage:i}}};function Te(){const{state:r,computed:o,actions:x}=be();return e.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"px-4 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-semibold text-foreground",children:"Marketplace"}),e.jsxs("button",{type:"button",onClick:x.openFilters,className:"inline-flex items-center gap-2 rounded-full bg-secondary/60 px-3 py-1 text-xs text-muted-foreground",children:[e.jsx(se,{size:14}),"Filters"]})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-border/60 bg-card px-3 py-2",children:[e.jsx(ee,{size:16,className:"text-muted-foreground"}),e.jsx("input",{value:r.searchQuery,onChange:l=>x.setSearchQuery(l.target.value),placeholder:"Search channels or @username",className:"flex-1 bg-transparent text-sm text-foreground placeholder:text-muted-foreground focus:outline-none"})]}),e.jsx(ue,{filters:r.filters,onRemoveFilter:x.removeFilter})]}),e.jsxs("div",{className:"px-4 py-6 space-y-3",children:[r.isLoading?Array.from({length:5}).map((l,y)=>e.jsx("div",{className:"rounded-2xl border border-border/50 bg-card/80 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(C,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(C,{className:"h-4 w-40"}),e.jsx(C,{className:"h-3 w-24"}),e.jsx(C,{className:"h-3 w-32"})]}),e.jsx(C,{className:"h-4 w-16"})]})},`marketplace-skeleton-${y}`)):o.channels.map(l=>e.jsx(de,{channel:l},l.id)),!r.isLoading&&r.error?e.jsx(J,{message:K(r.error,"Unable to load channels"),description:"Please try again when you have a stable connection.",onRetry:x.refetch}):null,!r.isLoading&&!r.error&&o.channels.length===0?e.jsx("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-6 text-center text-sm text-muted-foreground",children:"No channels found. Try a new search."}):null]}),e.jsx(ge,{isOpen:r.isFilterOpen,onClose:x.closeFilters,filters:r.filters,onApply:x.applyFilters,onReset:x.resetFilters})]})}export{Te as default};
