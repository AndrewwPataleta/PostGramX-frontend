import{u as N,d as j,e as y,r as m,j as e,L as C,R as u,b as E}from"./index-hL3AzeaV.js";import{u as v,R as k,g as w,a as R}from"./useVerifyChannel-Pqx2BBhR.js";import{P as f}from"./PageContainer-Cm-a9C2U.js";import{C as p}from"./channels-CCH0-4EZ.js";import{C as A}from"./ui-DLTU_43L.js";import{C as h}from"./chevron-left-BfQy29tv.js";import"./useMutation-D8gLmmlu.js";import"./channelsApi-CU2Ijv_1.js";import"./deals-CwuN94JF.js";const L=t=>t==null?"–":t>=1e6?`${(t/1e6).toFixed(1)}M`:t>=1e3?`${(t/1e3).toFixed(1)}K`:t.toString(),z=()=>{const t=N(),{id:o}=j(),i=y(),[c,l]=m.useState(null),{mutateAsync:b,isPending:d}=v(),n=m.useMemo(()=>i.state?.channel??null,[i.state]),s=i.state?.rootBackTo,g=async()=>{if(o){l(null);try{const r=await b(o);if(r.status===p.VERIFIED){const x=n?{...n,status:p.VERIFIED}:void 0;t(u.CHANNEL_MANAGE_LISTINGS(o),{replace:!0,state:x?{channel:x,rootBackTo:s}:s?{rootBackTo:s}:void 0});return}const a=w(r,"Verification failed. Please check your bot permissions and retry.");l(a)}catch(r){const a=R(r,"Unable to verify the channel right now.");l(a),E.error(a)}}};if(!o){const r=()=>{if(s){t(s,{replace:!0});return}t(-1)};return e.jsx("div",{className:"mx-auto w-full max-w-2xl",children:e.jsxs(f,{className:"py-6",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Channel not found."}),e.jsxs("button",{type:"button",onClick:r,className:"mt-4 inline-flex items-center gap-2 text-xs font-semibold text-primary",children:[e.jsx(h,{size:14}),"Back"]})]})})}return e.jsx("div",{className:"mx-auto flex w-full max-w-2xl flex-col",children:e.jsxs(f,{className:"py-6 space-y-6",children:[e.jsxs("button",{type:"button",onClick:()=>{if(s){t(s,{replace:!0});return}t(-1)},className:"inline-flex items-center gap-2 text-xs font-semibold text-muted-foreground",children:[e.jsx(h,{size:14}),"Back"]}),e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-5",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Pending verification"}),e.jsx("h1",{className:"mt-1 text-lg font-semibold text-foreground",children:n?.title||"Channel verification"}),n?.username?e.jsxs("p",{className:"text-sm text-muted-foreground",children:["@",n.username]}):null]}),e.jsx("span",{className:"rounded-full border border-yellow-500/40 bg-yellow-500/15 px-3 py-1 text-[11px] font-semibold text-yellow-200",children:A.PENDING_VERIFY})]}),e.jsxs("div",{className:"mt-4 rounded-xl bg-muted/30 p-3",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Members"}),e.jsx("p",{className:"mt-1 text-base font-semibold text-foreground",children:L(n?.memberCount)})]})]}),e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/70 p-5 text-sm text-muted-foreground",children:[e.jsx("p",{className:"text-sm font-semibold text-foreground",children:"Finish verification"}),e.jsxs("ul",{className:"mt-3 list-disc space-y-2 pl-5 text-xs",children:[e.jsx("li",{children:"Add the PostGram bot as an admin in your channel."}),e.jsx("li",{children:"Enable the “Post messages” permission for the bot."}),e.jsx("li",{children:"Return here and retry verification."})]})]}),c?e.jsx("div",{className:"rounded-xl border border-destructive/40 bg-destructive/10 px-4 py-3 text-xs text-destructive",children:c}):null,e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs("button",{type:"button",onClick:g,disabled:d,className:"inline-flex items-center justify-center gap-2 rounded-lg bg-primary px-4 py-3 text-sm font-semibold text-primary-foreground transition disabled:cursor-not-allowed disabled:opacity-70",children:[d?e.jsx(C,{size:16,className:"animate-spin"}):e.jsx(k,{size:16}),"Retry verification"]}),e.jsx("button",{type:"button",onClick:()=>t(u.CHANNELS),className:"inline-flex items-center justify-center rounded-lg border border-border/60 bg-card/80 px-4 py-3 text-sm font-semibold text-foreground",children:"Back to channels"})]})]})})};export{z as default};
