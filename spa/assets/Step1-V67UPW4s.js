import{e as C,r as i,j as e,d as j,u as v}from"./index-B5wV3xWl.js";import{u as N}from"./useMutation-Do8kPxLD.js";import{B as b}from"./button-ClPsxgSR.js";import{I as k}from"./input-C1f5C_1k.js";import{C as E,a as L}from"./card-BNHYGbER.js";import{a as w}from"./channelsApi-AVRj_0bi.js";import{g as I}from"./errorMapping-8iAQKN7i.js";import{u as S}from"./useAddChannelFlow-BM7mXIi_.js";const R=()=>{const d=C(),{state:a,setUsernameOrLink:m,setPreview:h,setLinkedChannelId:x,setLinkStatus:f,setVerifyStatus:p,setLastError:u}=S(),[r,c]=i.useState(a.usernameOrLink),[l,t]=i.useState(null);i.useEffect(()=>{c(a.usernameOrLink)},[a.usernameOrLink]);const o=N({mutationFn:s=>w({usernameOrLink:s}),onSuccess:(s,n)=>{h(s),m(n),x(null),f("idle"),p("idle"),u(null),t(null),d("/add-channel/step-2")},onError:s=>{const n=I(s);t(n),u(n),v.error(n)}}),g=()=>{const s=r.trim();if(!s){t("Please enter a channel username or link.");return}o.mutate(s)};return e.jsxs("div",{className:"flex flex-1 flex-col gap-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-base font-semibold text-foreground",children:"Add a Telegram channel"})}),e.jsx(E,{className:"border-border/60 bg-card/80 shadow-sm",children:e.jsxs(L,{className:"space-y-3 p-4",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:"Channel username or link"}),e.jsx(k,{placeholder:"@mychannel or https://t.me/mychannel",value:r,onChange:s=>{const n=s.target.value;c(n),m(n),l&&t(null)}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Public channels only. You must be an admin of the channel."}),l?e.jsx("p",{className:"text-xs font-medium text-destructive",children:l}):null]})}),e.jsx("div",{className:"mt-auto flex flex-col gap-3",children:e.jsx(b,{onClick:g,disabled:o.isPending||!r.trim(),className:"w-full text-sm font-semibold",children:o.isPending?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"h-4 w-4 animate-spin"}),"Checking channel"]}):"Continue"})})]})};export{R as default};
