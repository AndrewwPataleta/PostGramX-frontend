import{a as g,b,r as o,g as f,j as e,d as l}from"./index-BmMC9-4R.js";import{E as h,g as y}from"./errors-C_RbUixx.js";import{u as N}from"./use-deals-Dd3EQBf3.js";import"./useQuery--kIPnlyD.js";import"./useMutation-CeyoxhXq.js";function k(){const n=g(),r=b().state?.listingId,[i,c]=o.useState(""),[s,u]=o.useState(""),d=N(),a=d.isPending,m=!!r&&!a,x=o.useMemo(()=>{if(!s)return;const t=new Date(s);if(!Number.isNaN(t.getTime()))return t.toISOString()},[s]);o.useEffect(()=>{const t=f();!t?.MainButton?.showProgress||!t.MainButton.hideProgress||(a?t.MainButton.showProgress(!0):t.MainButton.hideProgress())},[a]);const p=async()=>{if(!r){l.error("Listing not found.");return}try{await d.mutateAsync({listingId:r,brief:i.trim()||void 0,scheduledAt:x}),n("/deals",{state:{activeTab:"pending"},replace:!0})}catch(t){l.error(y(t,"Unable to create deal"))}};return r?e.jsx("div",{className:"w-full max-w-2xl mx-auto",children:e.jsxs("div",{className:"px-4 py-6 space-y-4",children:[e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-4",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Listing"}),e.jsx("p",{className:"mt-1 text-sm font-semibold text-foreground",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Ready to create a deal"})]}),e.jsxs("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-semibold text-foreground",children:"Brief (optional)"}),e.jsx("textarea",{value:i,onChange:t=>c(t.target.value),placeholder:"Describe your product, key message, and desired tone.",className:"min-h-[120px] w-full rounded-xl border border-border/60 bg-background px-3 py-2 text-sm text-foreground focus:outline-none focus:ring-2 focus:ring-primary/30"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-xs font-semibold text-foreground",children:"Schedule datetime (optional)"}),e.jsx("input",{type:"datetime-local",value:s,onChange:t=>u(t.target.value),className:"w-full rounded-xl border border-border/60 bg-background px-3 py-2 text-sm text-foreground"})]})]}),e.jsx("button",{type:"button",onClick:p,disabled:!m,className:"w-full rounded-xl bg-primary px-4 py-3 text-sm font-semibold text-primary-foreground disabled:opacity-60",children:a?"Creating deal...":"Create deal"})]})}):e.jsx("div",{className:"w-full max-w-2xl mx-auto px-4 py-6",children:e.jsx(h,{message:"Listing not selected",description:"Please return to the marketplace and select a listing to continue.",onRetry:()=>n("/marketplace")})})}export{k as default};
