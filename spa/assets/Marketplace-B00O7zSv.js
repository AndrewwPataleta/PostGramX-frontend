import{c as K,j as e,L as D,X as N,r as m,u as G}from"./index-D1JYa1Mh.js";import{f as H,n as X}from"./ton-ClBVV2oW.js";import{C as B}from"./check-BW_IUSI9.js";import{f as J,l as W}from"./tagOptions-DoUmU6u5.js";import{C as w}from"./chevron-down-DJpH01nU.js";import{S as z}from"./skeleton-BKryotUH.js";import{E as Y}from"./ErrorState-mrL9QHMX.js";import{g as _}from"./errors-3kY4UU5q.js";import{u as Z}from"./useQuery-onZHD_1B.js";import{c as ee}from"./channelsApi-BRPRi62r.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ne=K("search",se);/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],te=K("sliders-horizontal",re),P="Must be pre-approved",M=3,ae=24,$=3,I=n=>{try{return BigInt(n)}catch{return null}};function oe({channel:n}){const o=(n.listings??[]).filter(a=>a.isActive!==!1),x=o.length,i=o.reduce((a,d)=>{const c=I(d.priceNano);return c===null?a:a===null||c<a?c:a},null),R=i?H(X(i)):null,t=o.some(a=>a.pinDurationHours!==null),l=typeof n.subscribers=="number"?`${Math.round(n.subscribers/1e3)}K subs`:null,y=new Set;let h=!1;o.forEach(a=>{a.tags.forEach(d=>{const c=d.trim();if(!(!c||c.length>ae)){if(c.toLowerCase()===P.toLowerCase()){h=!0;return}y.add(c)}})});const u=[...h?[P]:[],...Array.from(y)],F=u.slice(0,M),v=Math.max(u.length-M,0),S=n.name?.[0]?.toUpperCase()??n.username?.[0]?.toUpperCase(),C=o.some(a=>a.allowEdits),p=o.some(a=>a.allowLinkTracking),L=o.some(a=>a.allowPinnedPlacement||a.pinDurationHours!==null),O=o.some(a=>a.requiresApproval),k=[...C?["Edits allowed"]:[],...p?["Tracking allowed"]:[],...L?["Pinned available"]:[],...O?["Pre-approval required"]:[]],E=k.slice(0,$),T=Math.max(k.length-$,0),f=o.filter(a=>a.contentRulesText?.trim()).reduce((a,d)=>{const c=I(d.priceNano);return c===null?a:!a||c<a.price?{listing:d,price:c}:a},null)?.listing.contentRulesText?.trim()??null;return e.jsx(D,{to:`/marketplace/channels/${n.id}`,state:{channel:n},className:"block rounded-2xl border border-border/50 bg-card/80 p-4 transition-colors hover:border-primary/40",children:e.jsxs("div",{className:"flex items-start gap-3",children:[n.avatarUrl?e.jsx("img",{src:n.avatarUrl,alt:n.name,className:"h-12 w-12 rounded-full object-cover"}):e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-secondary/60 text-xl",children:S??"?"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:n.name}),n.verified?e.jsx("span",{className:"inline-flex items-center justify-center rounded-full bg-primary/20 p-1",children:e.jsx(B,{size:12,className:"text-primary"})}):null]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["@",n.username]}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] text-muted-foreground",children:[l?e.jsx("span",{children:l}):null,l?e.jsx("span",{children:"·"}):null,e.jsxs("span",{children:[x," placements"]}),t?e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"·"}),e.jsx("span",{children:"Pinned options available"})]}):null]}),u.length>0?e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] text-foreground",children:[F.map(a=>e.jsx("span",{className:`flex-none whitespace-nowrap rounded-full px-2.5 py-1 ${a===P?"bg-primary/20 text-primary":"bg-secondary/60"}`,children:a},a)),v>0?e.jsxs("span",{className:"flex-none whitespace-nowrap rounded-full bg-secondary/60 px-2.5 py-1 text-muted-foreground",children:["+",v]}):null]}):null,k.length>0?e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] text-muted-foreground",children:[E.map(a=>e.jsx("span",{className:"flex-none whitespace-nowrap rounded-full border border-border/60 px-2.5 py-1",children:a},a)),T>0?e.jsxs("span",{className:"flex-none whitespace-nowrap rounded-full border border-border/60 px-2.5 py-1 text-muted-foreground",children:["+",T]}):null]}):null,f?e.jsxs("p",{className:"mt-2 truncate text-xs text-muted-foreground",children:["Rules: ",f]}):null]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"From"}),e.jsxs("p",{className:"text-sm font-semibold text-primary",children:[R??"--"," TON"]})]})]})})}const le=({filters:n,onRemoveFilter:o})=>n.priceRange[0]>0||n.priceRange[1]<10||n.subscribersRange[0]>0||n.subscribersRange[1]<1e6||n.viewsRange[0]>0||n.viewsRange[1]<1e6||n.engagementRange?.[0]>0||n.engagementRange?.[1]<100||n.languages.length>0||n.categories.length>0||n.tags.length>0||n.verifiedOnly?e.jsx("div",{className:"px-4 py-3 bg-secondary/30 border-b border-border/30 space-y-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[n.priceRange[0]>0||n.priceRange[1]<10?e.jsxs("button",{onClick:()=>o("priceRange"),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Price: ",n.priceRange[0].toFixed(1),"-",n.priceRange[1].toFixed(1)," TON",e.jsx(N,{size:14})]}):null,n.subscribersRange[0]>0||n.subscribersRange[1]<1e6?e.jsxs("button",{onClick:()=>o("subscribersRange"),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Subs: ",(n.subscribersRange[0]/1e3).toFixed(0),"K-",(n.subscribersRange[1]/1e3).toFixed(0),"K",e.jsx(N,{size:14})]}):null,n.viewsRange[0]>0||n.viewsRange[1]<1e6?e.jsxs("button",{onClick:()=>o("viewsRange"),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Views: ",(n.viewsRange[0]/1e3).toFixed(0),"K-",(n.viewsRange[1]/1e3).toFixed(0),"K",e.jsx(N,{size:14})]}):null,n.engagementRange?.[0]>0||n.engagementRange?.[1]<100?e.jsxs("button",{onClick:()=>o("engagementRange"),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Engagement: ",n.engagementRange?.[0]??0,"%-",n.engagementRange?.[1]??100,"%",e.jsx(N,{size:14})]}):null,n.verifiedOnly?e.jsxs("button",{onClick:()=>o("verifiedOnly"),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:["Verified Only",e.jsx(N,{size:14})]}):null,n.languages.map(i=>e.jsxs("button",{onClick:()=>o("languages",i),className:"inline-flex items-center gap-1.5 bg-primary/20 hover:bg-primary/30 text-primary px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[i,e.jsx(N,{size:14})]},i)),n.categories.map(i=>e.jsxs("button",{onClick:()=>o("categories",i),className:"inline-flex items-center gap-1.5 bg-accent/20 hover:bg-accent/30 text-accent px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[i,e.jsx(N,{size:14})]},i)),n.tags.map(i=>e.jsxs("button",{onClick:()=>o("tags",i),className:"inline-flex items-center gap-1.5 bg-secondary/70 hover:bg-secondary text-foreground px-3 py-1.5 rounded-full text-xs font-medium transition-colors",children:[i,e.jsx(N,{size:14})]},i))]})}):null,ie=["EN","RU","ES","AR","DE","Other"],ce=["Crypto","Finance","Gaming","Tech","Lifestyle","News"],de=({isOpen:n,onClose:o,filters:x,onApply:i,onReset:R})=>{const[t,l]=m.useState(x),y=(s,r=1)=>new Intl.NumberFormat("en",{maximumFractionDigits:r}).format(s),h=s=>new Intl.NumberFormat("en",{notation:"compact",maximumFractionDigits:1}).format(s),[u,F]=m.useState({pricing:!0,audience:!0,engagement:!1,language:!1,category:!1,tags:!1,availability:!1,verification:!1}),[v,S]=m.useState(""),[C,p]=m.useState(""),L=J(W),O=[{label:"Any",range:[0,10]},{label:"0-1 TON",range:[0,1]},{label:"1-5 TON",range:[1,5]},{label:"5-10 TON",range:[5,10]}],k=[{label:"Any",range:[0,1e6]},{label:"0-10K",range:[0,1e4]},{label:"10-100K",range:[1e4,1e5]},{label:"100K-1M",range:[1e5,1e6]}],E=[{label:"Any",range:[0,1e6]},{label:"0-10K",range:[0,1e4]},{label:"10-100K",range:[1e4,1e5]},{label:"100K-1M",range:[1e5,1e6]}],T=[{label:"Any",range:[0,100]},{label:"0-5%",range:[0,5]},{label:"5-10%",range:[5,10]},{label:"10-25%",range:[10,25]},{label:"25%+",range:[25,100]}];m.useEffect(()=>{l(x)},[x,n]);const b=s=>{F(r=>({...r,[s]:!r[s]}))},f=(s,r)=>{const g=[...t.priceRange];g[s]=r,l(j=>({...j,priceRange:g}))},a=(s,r)=>{const g=[...t.subscribersRange];g[s]=r,l(j=>({...j,subscribersRange:g}))},d=(s,r)=>{const g=[...t.viewsRange];g[s]=r,l(j=>({...j,viewsRange:g}))},c=(s,r)=>{const g=[...t.engagementRange||[0,100]];g[s]=r,l(j=>({...j,engagementRange:g}))},V=s=>{l(r=>({...r,languages:r.languages.includes(s)?r.languages.filter(g=>g!==s):[...r.languages,s]}))},q=s=>{l(r=>({...r,categories:r.categories.includes(s)?r.categories.filter(g=>g!==s):[...r.categories,s]}))},Q=()=>{i(t),o()},U=()=>{R(),l({priceRange:[0,10],subscribersRange:[0,1e6],viewsRange:[0,1e6],engagementRange:[0,100],languages:[],categories:[],tags:[],verifiedOnly:!1,dateRange:["",""]})};return n?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black/40 z-40",onClick:o}),e.jsxs("div",{className:"fixed inset-x-0 bottom-0 top-0 bg-card rounded-t-2xl z-50 animate-in slide-in-from-bottom-10 duration-300 flex flex-col h-[100dvh] sm:h-auto sm:top-auto sm:max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"bg-card border-b border-border/50 px-4 py-4 flex items-center justify-between rounded-t-2xl shrink-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Filters"}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-secondary rounded-lg transition-colors",children:e.jsx(N,{size:20,className:"text-foreground"})})]}),e.jsxs("div",{className:"px-4 py-4 space-y-4 flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("pricing"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Pricing (TON)"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.pricing?"rotate-180":""}`})]}),u.pricing&&e.jsxs("div",{className:"px-3 space-y-3 pb-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:O.map(s=>e.jsx("button",{onClick:()=>l(r=>({...r,priceRange:s.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${t.priceRange[0]===s.range[0]&&t.priceRange[1]===s.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s.label},s.label))}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:t.priceRange[0],onChange:s=>f(0,parseFloat(s.target.value)||0),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min"}),e.jsx("input",{type:"number",value:t.priceRange[1],onChange:s=>f(1,parseFloat(s.target.value)||10),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[y(t.priceRange[0])," -"," ",y(t.priceRange[1])," TON"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("audience"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Audience"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.audience?"rotate-180":""}`})]}),u.audience&&e.jsxs("div",{className:"px-3 space-y-4 pb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Subscribers"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:k.map(s=>e.jsx("button",{onClick:()=>l(r=>({...r,subscribersRange:s.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${t.subscribersRange[0]===s.range[0]&&t.subscribersRange[1]===s.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s.label},s.label))}),e.jsxs("div",{className:"flex flex-col gap-2 mb-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:t.subscribersRange[0],onChange:s=>a(0,parseInt(s.target.value)||0),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min"}),e.jsx("input",{type:"number",value:t.subscribersRange[1],onChange:s=>a(1,parseInt(s.target.value)||1e6),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[h(t.subscribersRange[0])," -"," ",h(t.subscribersRange[1])]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"Average Views"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:E.map(s=>e.jsx("button",{onClick:()=>l(r=>({...r,viewsRange:s.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${t.viewsRange[0]===s.range[0]&&t.viewsRange[1]===s.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s.label},s.label))}),e.jsxs("div",{className:"flex flex-col gap-2 mb-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:t.viewsRange[0],onChange:s=>d(0,parseInt(s.target.value)||0),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min"}),e.jsx("input",{type:"number",value:t.viewsRange[1],onChange:s=>d(1,parseInt(s.target.value)||1e6),className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-xs text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[h(t.viewsRange[0])," -"," ",h(t.viewsRange[1])]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("engagement"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Engagement Rate"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.engagement?"rotate-180":""}`})]}),u.engagement&&e.jsxs("div",{className:"px-3 space-y-3 pb-3",children:[e.jsx("div",{className:"flex flex-wrap gap-2",children:T.map(s=>e.jsx("button",{onClick:()=>l(r=>({...r,engagementRange:s.range})),className:`px-3 py-1.5 rounded-full text-xs font-medium transition-all ${t.engagementRange?.[0]===s.range[0]&&t.engagementRange?.[1]===s.range[1]?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s.label},s.label))}),e.jsxs("div",{className:"flex flex-col gap-2 sm:flex-row",children:[e.jsx("input",{type:"number",value:t.engagementRange?.[0]??0,onChange:s=>c(0,parseFloat(s.target.value)||0),min:"0",max:"100",className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Min %"}),e.jsx("input",{type:"number",value:t.engagementRange?.[1]??100,onChange:s=>c(1,parseFloat(s.target.value)||100),min:"0",max:"100",className:"w-full min-w-0 flex-1 bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50",placeholder:"Max %"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(t.engagementRange?.[0]??0).toFixed(0),"% -"," ",(t.engagementRange?.[1]??100).toFixed(0),"%"]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("language"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Language"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.language?"rotate-180":""}`})]}),u.language&&e.jsx("div",{className:"px-3 pb-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:ie.map(s=>e.jsx("button",{onClick:()=>V(s),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${t.languages.includes(s)?"bg-primary text-primary-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s},s))})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("category"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Category"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.category?"rotate-180":""}`})]}),u.category&&e.jsx("div",{className:"px-3 pb-3",children:e.jsx("div",{className:"flex flex-wrap gap-2",children:ce.map(s=>e.jsx("button",{onClick:()=>q(s),className:`px-4 py-2 rounded-full text-sm font-medium transition-all ${t.categories.includes(s)?"bg-accent text-accent-foreground":"bg-secondary text-foreground hover:bg-secondary/80"}`,children:s},s))})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("tags"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Tags"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.tags?"rotate-180":""}`})]}),u.tags&&e.jsxs("div",{className:"px-3 pb-3 space-y-3",children:[e.jsx("input",{type:"text",value:v,onChange:s=>S(s.target.value),placeholder:"Search tags",className:"w-full rounded-lg border border-border bg-input px-3 py-2 text-sm text-foreground"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:C,onChange:s=>p(s.target.value),placeholder:"Add custom tag",className:"flex-1 rounded-lg border border-border bg-input px-3 py-2 text-sm text-foreground"}),e.jsx("button",{type:"button",onClick:()=>{const s=C.trim();s&&(l(r=>({...r,tags:r.tags.includes(s)?r.tags:[...r.tags,s]})),p(""))},className:"rounded-lg border border-primary/40 bg-primary/10 px-3 py-2 text-xs font-semibold text-primary",children:"Add"})]}),t.tags.length>0?e.jsx("div",{className:"flex flex-wrap gap-2",children:t.tags.map(s=>e.jsxs("button",{type:"button",onClick:()=>l(r=>({...r,tags:r.tags.filter(g=>g!==s)})),className:"rounded-full bg-secondary px-3 py-1 text-xs text-foreground hover:bg-secondary/80",children:[s," ×"]},s))}):null,e.jsx("div",{className:"flex flex-wrap gap-2",children:L.filter(s=>s.toLowerCase().includes(v.trim().toLowerCase())).map(s=>{const r=t.tags.includes(s);return e.jsx("button",{type:"button",onClick:()=>l(g=>({...g,tags:r?g.tags.filter(j=>j!==s):[...g.tags,s]})),className:`rounded-full border px-3 py-1 text-xs transition-colors ${r?"border-primary/60 bg-primary/20 text-primary":"border-border/60 bg-card text-muted-foreground hover:text-foreground"}`,children:s},s)})})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("availability"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Availability"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.availability?"rotate-180":""}`})]}),u.availability&&e.jsxs("div",{className:"px-3 pb-3 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"From date"}),e.jsx("input",{type:"date",value:t.dateRange[0],onChange:s=>l(r=>({...r,dateRange:[s.target.value,r.dateRange[1]]})),className:"w-full bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground mb-2",children:"To date"}),e.jsx("input",{type:"date",value:t.dateRange[1],onChange:s=>l(r=>({...r,dateRange:[r.dateRange[0],s.target.value]})),className:"w-full bg-input border border-border rounded-lg px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-primary/50"})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:()=>b("verification"),className:"w-full flex items-center justify-between p-3 hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("span",{className:"font-semibold text-foreground",children:"Verification"}),e.jsx(w,{size:18,className:`text-muted-foreground transition-transform ${u.verification?"rotate-180":""}`})]}),u.verification&&e.jsx("div",{className:"px-3 pb-3",children:e.jsxs("label",{className:"flex items-center gap-3 p-3 cursor-pointer hover:bg-secondary/50 rounded-lg transition-colors",children:[e.jsx("input",{type:"checkbox",checked:t.verifiedOnly,onChange:s=>l(r=>({...r,verifiedOnly:s.target.checked})),className:"w-5 h-5 bg-secondary border border-border rounded accent-primary cursor-pointer"}),e.jsx("span",{className:"text-foreground font-medium",children:"Verified channels only"})]})})]})]}),e.jsxs("div",{className:"sticky bottom-0 bg-card border-t border-border/50 px-4 py-4 space-y-3",children:[e.jsx("button",{onClick:Q,className:"button-primary w-full py-3 text-base font-semibold",children:"Apply Filters"}),e.jsx("button",{onClick:U,className:"button-secondary w-full py-3 text-base font-semibold",children:"Reset"})]})]})]}):null},A={priceRange:[0,100],subscribersRange:[0,1e6],viewsRange:[0,1e6],engagementRange:[0,100],languages:[],categories:[],tags:[],verifiedOnly:!0,dateRange:["",""]},ue={channels:n=>["channels",n]},ge=()=>{const[n,o]=m.useState(""),[x,i]=m.useState(""),[R,t]=m.useState(!1),[l,y]=m.useState(A),[h,u]=m.useState(1),[F]=m.useState(20),[v]=m.useState("recent"),[S]=m.useState("desc");m.useEffect(()=>{const f=window.setTimeout(()=>{i(n.trim())},300);return()=>{window.clearTimeout(f)}},[n]);const C=m.useMemo(()=>({q:x||void 0,verifiedOnly:l.verifiedOnly||void 0,page:h,limit:F,sort:v,order:S,includeListings:!0}),[x,l.verifiedOnly,F,S,h,v]),p=Z({queryKey:ue.channels(C),queryFn:()=>ee.listChannels(C)});m.useEffect(()=>{p.error&&G.error(_(p.error,"Unable to load channels"))},[p.error]);const L=m.useMemo(()=>(p.data?.items??[]).filter(a=>(a.listings??[]).filter(c=>c.isActive!==!1).length>0),[p.data?.items]),O=(f,a)=>{y(d=>{switch(f){case"priceRange":return{...d,priceRange:A.priceRange};case"subscribersRange":return{...d,subscribersRange:A.subscribersRange};case"viewsRange":return{...d,viewsRange:A.viewsRange};case"engagementRange":return{...d,engagementRange:A.engagementRange};case"verifiedOnly":return{...d,verifiedOnly:!1};case"languages":return{...d,languages:d.languages.filter(c=>c!==a)};case"categories":return{...d,categories:d.categories.filter(c=>c!==a)};case"tags":return{...d,tags:d.tags.filter(c=>c!==a)};default:return d}})},k=()=>t(!0),E=()=>t(!1),T=f=>y(f),b=()=>y(A);return{state:{searchQuery:n,isFilterOpen:R,filters:l,isLoading:p.isLoading,error:p.error},computed:{channels:L},actions:{setSearchQuery:o,openFilters:k,closeFilters:E,applyFilters:T,resetFilters:b,removeFilter:O,refetch:()=>p.refetch(),setPage:u}}};function we(){const{state:n,computed:o,actions:x}=ge();return e.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[e.jsxs("div",{className:"px-4 pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-base font-semibold text-foreground",children:"Marketplace"}),e.jsxs("button",{type:"button",onClick:x.openFilters,className:"inline-flex items-center gap-2 rounded-full bg-secondary/60 px-3 py-1 text-xs text-muted-foreground",children:[e.jsx(te,{size:14}),"Filters"]})]}),e.jsxs("div",{className:"flex items-center gap-2 rounded-2xl border border-border/60 bg-card px-3 py-2",children:[e.jsx(ne,{size:16,className:"text-muted-foreground"}),e.jsx("input",{value:n.searchQuery,onChange:i=>x.setSearchQuery(i.target.value),placeholder:"Search channels or @username",className:"flex-1 bg-transparent text-sm text-foreground placeholder:text-muted-foreground focus:outline-none"})]}),e.jsx(le,{filters:n.filters,onRemoveFilter:x.removeFilter})]}),e.jsxs("div",{className:"px-4 py-6 space-y-3",children:[n.isLoading?Array.from({length:5}).map((i,R)=>e.jsx("div",{className:"rounded-2xl border border-border/50 bg-card/80 p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(z,{className:"h-12 w-12 rounded-full"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(z,{className:"h-4 w-40"}),e.jsx(z,{className:"h-3 w-24"}),e.jsx(z,{className:"h-3 w-32"})]}),e.jsx(z,{className:"h-4 w-16"})]})},`marketplace-skeleton-${R}`)):o.channels.map(i=>e.jsx(oe,{channel:i},i.id)),!n.isLoading&&n.error?e.jsx(Y,{message:_(n.error,"Unable to load channels"),description:"Please try again when you have a stable connection.",onRetry:x.refetch}):null,!n.isLoading&&!n.error&&o.channels.length===0?e.jsx("div",{className:"rounded-2xl border border-border/60 bg-card/80 p-6 text-center text-sm text-muted-foreground",children:"No channels found. Try a new search."}):null]}),e.jsx(de,{isOpen:n.isFilterOpen,onClose:x.closeFilters,filters:n.filters,onApply:x.applyFilters,onReset:x.resetFilters})]})}export{we as default};
