import{u as v,a as C,r as d,b as N,j as e,L as b}from"./index-D4cJLd4-.js";import{u as L}from"./useMutation-Cnc7nd8C.js";import{B as k}from"./button-WIiOkIWr.js";import{I as E}from"./input-CWtmfPDk.js";import{C as w,a as I}from"./card-ID4SJrAz.js";import{a as S}from"./channelsApi-CaBKYloI.js";import{g as O}from"./errorMapping-HxgZRW_j.js";import{u as F}from"./useAddChannelFlow-CtHsZLVB.js";const V=()=>{const x=v(),{t:n}=C(),{state:r,setUsernameOrLink:c,setPreview:h,setLinkedChannelId:p,setLinkStatus:f,setVerifyStatus:g,setLastError:m}=F(),[l,u]=d.useState(r.usernameOrLink),[o,a]=d.useState(null);d.useEffect(()=>{u(r.usernameOrLink)},[r.usernameOrLink]);const i=L({mutationFn:s=>S({usernameOrLink:s}),onSuccess:(s,t)=>{h(s),c(t),p(null),f("idle"),g("idle"),m(null),a(null),x("/add-channel/step-2")},onError:s=>{const t=O(s);a(t),m(t),N.error(t)}}),j=()=>{const s=l.trim();if(!s){const t=n("errors.validation.channelUsernameRequired");a(t);return}i.mutate(s)};return e.jsxs("div",{className:"flex flex-1 flex-col gap-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-base font-semibold text-foreground",children:n("channels.add.step1.title")})}),e.jsx(w,{className:"border-border/60 bg-card/80 shadow-sm",children:e.jsxs(I,{className:"space-y-3 p-4",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:n("channels.add.step1.label")}),e.jsx(E,{placeholder:n("channels.add.step1.placeholder"),value:l,onChange:s=>{const t=s.target.value;u(t),c(t),o&&a(null)}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n("channels.add.step1.hint")}),o?e.jsx("p",{className:"text-xs font-medium text-destructive",children:o}):null]})}),e.jsx("div",{className:"mt-auto flex flex-col gap-3",children:e.jsx(k,{onClick:j,disabled:i.isPending||!l.trim(),className:"w-full text-sm font-semibold",children:i.isPending?e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"h-4 w-4 animate-spin"}),n("channels.add.step1.checking")]}):n("common.continue")})})]})};export{V as default};
