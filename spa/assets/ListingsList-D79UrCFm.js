import{c as A,a as L,j as e,H as E,d as S,e as M,r as m,b as w,B as h,R as y}from"./index-De87KF61.js";import{u as k}from"./useQuery-CrxPqRvD.js";import{a as C,d as I}from"./formatters-CG109iVp.js";import{h as v,b as _,c as P}from"./labels-EEWNt0UM.js";import{g as D}from"./tagOptions-DHtvjoWf.js";import{L as H}from"./LoadingSkeleton-BgXDJ6ZE.js";import{l as G}from"./listingsApi-BIZTC8Jt.js";import{g as O}from"./errors-3kY4UU5q.js";import{P as z}from"./plus-ru4NjgAM.js";import"./ton-ClBVV2oW.js";import"./skeleton-DRS-xsuG.js";/**
 * @license lucide-react v0.539.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],R=A("square-pen",B);function q({listing:r,variant:t="full",actionSlot:u}){const{t:s,language:i}=L(),n=r.tags??[],a=[...new Set([...n.filter(o=>o==="Must be pre-approved"),...n.filter(o=>o!=="Must be pre-approved")])],g=t==="compact"?3:a.length,d=a.slice(0,g),p=Math.max(0,a.length-d.length),j=r.visibilityDurationHours??24,x=r.pinDurationHours?v(r.pinDurationHours,s):null,N=v(j,s),l="priceNano"in r?C(r.priceNano,i):I(r.priceTon,i);return e.jsxs("div",{className:`rounded-2xl border border-border/60 bg-card/80 p-4 ${t==="compact"?"space-y-3":"space-y-4"}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-foreground",children:[s("listings.format.POST")," â€¢ ",l," ",s("common.ton")]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s(t==="compact"?"listings.perPost":"listings.perPostOffer")})]}),e.jsx("span",{className:`rounded-full px-2.5 py-1 text-[11px] font-semibold ${r.isActive?"bg-emerald-500/15 text-emerald-400":"bg-rose-500/15 text-rose-400"}`,children:r.isActive?s("listings.status.active"):s("listings.status.inactive")})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[e.jsx("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1 text-foreground",children:_(s,r.allowEdits)}),e.jsx("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1 text-foreground",children:P(s,r.allowLinkTracking)})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-foreground",children:[x?e.jsxs("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1",children:[s("listings.pinnedLabel"),": ",x]}):e.jsxs("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1",children:[s("listings.pinnedLabel"),": ",s("common.none")]}),e.jsxs("span",{className:"rounded-full bg-secondary/60 px-2.5 py-1",children:[s("listings.visibleLabel"),": ",N]})]}),a.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-foreground",children:[d.map(o=>{const f=o==="Must be pre-approved";return e.jsx("span",{className:`rounded-full border px-2.5 py-1 ${f?"border-primary/40 bg-primary/10 text-primary":"border-border/60 bg-card text-foreground"}`,children:D(o,s)},o)}),p>0?e.jsxs("span",{className:"rounded-full border border-border/60 bg-card px-2.5 py-1 text-muted-foreground",children:["+",p]}):null]}):null,t==="full"&&u?e.jsx("div",{className:"flex gap-2",children:u}):null]})}const ee=()=>{const{channel:r}=E(),{t}=L(),{id:u}=S(),s=M(),i=u??r.id,n=s.state?.rootBackTo,[a,g]=m.useState(1),[d]=m.useState(10),[p,j]=m.useState(!0),[x,N]=m.useState("recent"),l=k({queryKey:["listingsByChannel",i,{page:a,limit:d,onlyActive:p,sort:x}],queryFn:()=>G({channelId:i,page:a,limit:d,onlyActive:p,sort:x})});m.useEffect(()=>{l.error&&w.error(O(l.error,t("listings.loadError")))},[l.error,t]);const o=l.data?.items??[],f=l.data?.total??0,b=m.useMemo(()=>Math.max(1,Math.ceil(f/d)),[f,d]),T=o.length>0;return e.jsxs(e.Fragment,{children:[l.isLoading?e.jsx(H,{items:3}):T?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-3",children:o.map(c=>e.jsx(q,{listing:c,variant:"full",actionSlot:e.jsxs(h,{to:y.CHANNEL_MANAGE_LISTINGS_EDIT(i,c.id),state:n?{rootBackTo:n}:void 0,className:"flex-1 flex items-center justify-center gap-2 bg-secondary hover:bg-secondary/80 text-foreground font-medium py-2 rounded-lg border border-border transition-colors text-sm",children:[e.jsx(R,{size:16}),t("listings.editAction")]})},c.id))}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsx("span",{children:t("common.pageOf",{page:a,total:b})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{type:"button",onClick:()=>g(c=>Math.max(1,c-1)),disabled:a===1,className:"rounded-lg border border-border/60 px-3 py-1 text-xs disabled:opacity-50",children:t("common.previous")}),e.jsx("button",{type:"button",onClick:()=>g(c=>Math.min(b,c+1)),disabled:a>=b,className:"rounded-lg border border-border/60 px-3 py-1 text-xs disabled:opacity-50",children:t("common.next")})]})]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-secondary/30 flex items-center justify-center mx-auto mb-3",children:e.jsx("span",{className:"text-xl",children:t("listings.emptyIcon")})}),e.jsx("p",{className:"text-foreground font-semibold mb-2",children:t("listings.emptyTitle")}),e.jsx("p",{className:"text-muted-foreground text-sm mb-6",children:t("listings.emptySubtitle")}),e.jsx(h,{to:y.CHANNEL_MANAGE_LISTINGS_CREATE(i),state:n?{rootBackTo:n}:void 0,className:"inline-flex items-center justify-center rounded-lg bg-primary px-4 py-2 text-xs font-semibold text-primary-foreground",children:t("listings.createAction")})]}),e.jsx(h,{to:y.CHANNEL_MANAGE_LISTINGS_CREATE(i),state:n?{rootBackTo:n}:void 0,className:"fixed bottom-[calc(var(--tg-content-safe-area-inset-bottom)+120px)] right-4 z-40 flex h-12 w-12 items-center justify-center rounded-2xl bg-primary text-primary-foreground shadow-lg shadow-primary/30 transition hover:bg-primary/90","aria-label":t("listings.createAction"),children:e.jsx(z,{size:18})})]})};export{ee as default};
