import{u as C,a as v,r as d,b as N,R as E,j as e,L}from"./index-DjgcfNCA.js";import{u as b}from"./useMutation-ZHRf5x4X.js";import{B as k}from"./button-CmVV4fPk.js";import{I as S}from"./input-DsBHBLTz.js";import{C as w,a as I}from"./card-BAAn2DBT.js";import{a as O}from"./channelsApi-CuTxKwuT.js";import{g as A}from"./errorMapping-Cm2biJQB.js";import{u as P}from"./useAddChannelFlow-DaB-ZD0d.js";const _=()=>{const x=C(),{t:n}=v(),{state:r,setUsernameOrLink:m,setPreview:p,setLinkedChannelId:h,setLinkStatus:f,setVerifyStatus:g,setLastError:c}=P(),[l,u]=d.useState(r.usernameOrLink),[o,a]=d.useState(null);d.useEffect(()=>{u(r.usernameOrLink)},[r.usernameOrLink]);const i=b({mutationFn:s=>O({usernameOrLink:s}),onSuccess:(s,t)=>{p(s),m(t),h(null),f("idle"),g("idle"),c(null),a(null),x(E.ADD_CHANNEL_STEP("step-2"))},onError:s=>{const t=A(s);a(t),c(t),N.error(t)}}),j=()=>{const s=l.trim();if(!s){const t=n("errors.validation.channelUsernameRequired");a(t);return}i.mutate(s)};return e.jsxs("div",{className:"flex flex-1 flex-col gap-4",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-base font-semibold text-foreground",children:n("channels.add.step1.title")})}),e.jsx(w,{className:"border-border/60 bg-card/80 shadow-sm",children:e.jsxs(I,{className:"space-y-3 p-4",children:[e.jsx("label",{className:"text-xs font-medium text-muted-foreground",children:n("channels.add.step1.label")}),e.jsx(S,{placeholder:n("channels.add.step1.placeholder"),value:l,onChange:s=>{const t=s.target.value;u(t),m(t),o&&a(null)}}),e.jsx("p",{className:"text-xs text-muted-foreground",children:n("channels.add.step1.hint")}),o?e.jsx("p",{className:"text-xs font-medium text-destructive",children:o}):null]})}),e.jsx("div",{className:"mt-auto flex flex-col gap-3",children:e.jsx(k,{onClick:j,disabled:i.isPending||!l.trim(),className:"w-full text-sm font-semibold",children:i.isPending?e.jsxs(e.Fragment,{children:[e.jsx(L,{className:"h-4 w-4 animate-spin"}),n("channels.add.step1.checking")]}):n("common.continue")})})]})};export{_ as default};
