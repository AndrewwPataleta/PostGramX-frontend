import{r as m,j as e,f as p}from"./index-Dr4_lYQJ.js";import{f as C,n as D}from"./ton-ClBVV2oW.js";import{C as L}from"./chevron-down-D7ZVjZnw.js";const j=3,v=r=>{if(!r)return null;try{return C(D(r))}catch{return r}},N=r=>{const t=r.map(n=>n.trim()).filter(Boolean),s=Array.from(new Set(t));return{visible:s.slice(0,j),hiddenCount:Math.max(s.length-j,0)}},h=r=>r>=168&&r%24===0?`${r/24}d`:`${r}h`,k=({listings:r})=>r.length===0?e.jsx("div",{className:"rounded-xl border border-dashed border-border/60 bg-background/50 px-4 py-4 text-center text-xs text-muted-foreground",children:"No placements available yet."}):e.jsx("div",{className:"space-y-3",children:r.map(t=>{const s=N(t.tags??[]),n=[t.allowEdits?"Edits allowed":null,t.allowLinkTracking?"Tracking allowed":null].filter(Boolean),d=v(t.priceNano)??t.priceNano,l=t.pinDurationHours?`Pinned ${h(t.pinDurationHours)}`:"Not pinned",u=`Visible ${h(t.visibilityDurationHours)}`,i=t.contentRulesText?.trim();return e.jsxs("div",{className:"rounded-xl border border-border/60 bg-card/80 p-3",children:[e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"text-sm font-semibold text-foreground",children:[d," TON"]}),e.jsx("span",{className:"rounded-full border border-border/60 bg-muted/40 px-2 py-0.5 text-[10px] font-semibold text-muted-foreground",children:t.format})]}),e.jsxs("div",{className:"mt-2 text-[11px] text-muted-foreground",children:[l," • ",u]}),n.length>0?e.jsx("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] text-muted-foreground",children:n.map(a=>e.jsx("span",{className:"rounded-full border border-border/60 bg-muted/30 px-2 py-0.5",children:a},a))}):null,s.visible.length>0?e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2 text-[11px] text-muted-foreground",children:[s.visible.map(a=>e.jsx("span",{className:"rounded-full border border-border/60 bg-card px-2 py-0.5 text-foreground",children:a},`${t.id}-${a}`)),s.hiddenCount>0?e.jsxs("span",{className:"rounded-full border border-border/60 bg-card px-2 py-0.5",children:["+",s.hiddenCount]}):null]}):null,i?e.jsx("p",{className:"mt-2 line-clamp-2 text-[11px] text-muted-foreground",children:i}):null]},t.id)})});function M({channel:r,onClick:t,actions:s,isExpanded:n,onToggleExpand:d,expandedContent:l}){const[u,i]=m.useState(!1),[a,y]=m.useState(!1),x=n??u,b=!!(d||l||r.listingsPreview),w=m.useMemo(()=>v(r.minPriceNano),[r.minPriceNano]),c=N(r.tags??[]),f=r.username?`@${r.username.replace(/^@/,"")}`:null,E=r.name?.[0]?.toUpperCase()??"?",g=!a&&r.avatarUrl?r.avatarUrl:null,T=r.placementsCount!=null?r.placementsCount.toString():"—",P=typeof r.subscribers=="number"?r.subscribers.toLocaleString():"—",S=o=>{o.stopPropagation(),d?d():i($=>!$)};return e.jsxs("div",{className:p("w-full rounded-2xl border border-border/50 bg-card/80 p-4 text-left shadow-sm transition",t&&"cursor-pointer hover:border-border/80 hover:bg-card"),role:t?"button":void 0,tabIndex:t?0:void 0,onClick:t,onKeyDown:o=>{t&&(o.key==="Enter"||o.key===" ")&&(o.preventDefault(),t())},children:[e.jsxs("div",{className:"flex items-start gap-3",children:[g?e.jsx("img",{src:g,alt:r.name,className:"h-12 w-12 rounded-full object-cover",onError:()=>y(!0)}):e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-primary/30 via-secondary/50 to-secondary text-lg text-foreground",children:E}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-semibold text-foreground",children:r.name}),f?e.jsx("span",{className:"text-xs text-muted-foreground",children:f}):null]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s,b?e.jsx("button",{type:"button",onClick:S,"aria-expanded":x,className:"inline-flex h-8 w-8 items-center justify-center rounded-lg border border-border/60 bg-secondary/40 text-muted-foreground transition hover:text-foreground",children:e.jsx(L,{size:16,className:p("transition-transform duration-200",x&&"rotate-180")})}):null]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:[e.jsxs("span",{children:[T," placements"]}),e.jsx("span",{children:"·"}),e.jsxs("span",{children:[P," subscribers"]})]}),e.jsx("div",{className:"flex flex-wrap items-center gap-2 text-xs text-muted-foreground",children:e.jsxs("span",{children:["From"," ",e.jsxs("span",{className:"font-semibold text-primary",children:[w??"—"," TON"]})]})}),c.visible.length>0?e.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px] text-muted-foreground",children:[c.visible.map(o=>e.jsx("span",{className:"rounded-full border border-border/60 bg-card px-2.5 py-1 text-foreground",children:o},`${r.id}-${o}`)),c.hiddenCount>0?e.jsxs("span",{className:"rounded-full border border-border/60 bg-card px-2.5 py-1 text-muted-foreground",children:["+",c.hiddenCount]}):null]}):null]})]}),b?e.jsx("div",{className:p("overflow-hidden transition-all duration-300",x?"mt-4 max-h-[1200px] opacity-100":"max-h-0 opacity-0"),children:e.jsx("div",{className:"rounded-2xl border border-border/60 bg-background/60 p-3",children:l||e.jsx(k,{listings:r.listingsPreview??[]})})}):null]})}export{M as C};
